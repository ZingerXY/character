function autoArr(){var t=[[],[]];if(!emptyObject(mychar.perks)){var s=[];for(var a in mychar.perks)for(var r in mychar.perks[a].lvl)s[mychar.perks[a].lvl[r]]=a;for(var a in s)t[0].push(a),t[1].push(autoPidPerk[s[a]]),console.log(a,autoPidPerk[s[a]],s[a],textperk[s[a]][0])}console.log(t[0].join("|")+"&"+t[1].join("|"))}function lzw(t){for(var s,a={},r=(t+"").split(""),e=[],i=r[0],n=200,l=1;l<r.length;l++)null!=a[i+(s=r[l])]?i+=s:(e.push(i.length>1?a[i]:i.charCodeAt(0)),a[i+s]=n,n++,i=s);e.push(i.length>1?a[i]:i.charCodeAt(0));for(l=0;l<e.length;l++)e[l]=String.fromCharCode(e[l]);return e.join("")}function delzw(t){for(var s,a={},r=(t+"").split(""),e=r[0],i=e,n=[e],l=200,c=1;c<r.length;c++){var o=r[c].charCodeAt(0);s=200>o?r[c]:a[o]?a[o]:i+e,n.push(s),e=s.charAt(0),a[l]=i+e,l++,i=s}return n.join("")}autoPidPerk={PE_MEDIAL:300,PE_RATING:301,PE_BONUS_HTH_ATTACKS:302,PE_BONUS_HTH_DAMAGE:303,PE_BONUS_MOVE:304,PE_BONUS_RANGED_DAMAGE:305,PE_BONUS_RATE_OF_FIRE:306,PE_EARLIER_SEQUENCE:307,PE_FASTER_HEALING:308,PE_MORE_CRITICALS:309,PE_NIGHT_VISION:310,PE_PRESENCE:311,PE_RAD_RESISTANCE:312,PE_TOUGHNESS:313,PE_STRONG_BACK:314,PE_SHARPSHOOTER:315,PE_SILENT_RUNNING:316,PE_SURVIVALIST:317,PE_MASTER_TRADER:318,PE_EDUCATED:319,PE_HEALER:320,PE_FORTUNE_FINDER:321,PE_BETTER_CRITICALS:322,PE_EMPATHY:323,PE_SLAYER:324,PE_SNIPER:325,PE_SILENT_DEATH:326,PE_ACTION_BOY:327,PE_MENTAL_BLOCK:328,PE_LIFEGIVER:329,PE_DODGER:330,PE_SNAKEATER:331,PE_MR_FIXIT:332,PE_MEDIC:333,PE_MASTER_THIEF:334,PE_SPEAKER:335,PE_HEAVE_HO:336,PE_FRIENDLY_FOE:337,PE_PICKPOCKET:338,PE_GHOST:339,PE_CULT_OF_PERSONALITY:340,PE_SCROUNGER:341,PE_EXPLORER:342,PE_FLOWER_CHILD:343,PE_PATHFINDER:344,PE_ANIMAL_FRIEND:345,PE_SCOUT:346,PE_MYSTERIOUS_STRANGER:347,PE_RANGER:348,PE_QUICK_POCKETS:349,PE_SMOOTH_TALKER:350,PE_SWIFT_LEARNER:351,PE_TAG:352,PE_MUTATE:353,PE_BOOKWORM:354,PE_AWARENESS:355,PE_BIVALIY:356,PE_PALESKIN:357,PE_GECKON:358,PE_GUY:359,PE_BIGSKIN:360,PE_MASTERMELE:361,PE_COWBOY:362,PE_FISTRAGE:363,PE_ADEPTGLOW:364,PE_FANAT:365,PE_STOIK:366,PE_CRITTER:367,PE_TARGETING:368,PE_RAGE:370,PE_DEFENCE:371,PE_ATTACK:372,PE_HARD:373,PE_VIEW:374,PE_ADRENALINE_RUSH:380,PE_CAUTIOUS_NATURE:381,PE_COMPREHENSION:382,PE_DEMOLITION_EXPERT:383,PE_GAMBLER:384,PE_GAIN_STRENGTH:385,PE_GAIN_PERCEPTION:386,PE_GAIN_ENDURANCE:387,PE_GAIN_CHARISMA:388,PE_GAIN_INTELLIGENCE:389,PE_GAIN_AGILITY:390,PE_GAIN_LUCK:391,PE_HARMLESS:392,PE_HERE_AND_NOW:393,PE_HTH_EVADE:394,PE_KAMA_SUTRA_MASTER:395,PE_KARMA_BEACON:396,PE_LIGHT_STEP:397,PE_LIVING_ANATOMY:398,PE_MAGNETIC_PERSONALITY:399,PE_NEGOTIATOR:400,PE_PACK_RAT:401,PE_PYROMANIAC:402,PE_QUICK_RECOVERY:403,PE_SALESMAN:404,PE_STONEWALL:405,PE_THIEF:406,PE_WEAPON_HANDLING:407,PE_VAULT_CITY_TRAINING:408,PE_ALCOHOL_RAISED_HP:409,PE_ALCOHOL_RAISED_HP_II:410,PE_ALCOHOL_LOWERED_HP:411,PE_ALCOHOL_LOWERED_HP_II:412,PE_AUTODOC_RAISED_HP:413,PE_AUTODOC_RAISED_HP_II:414,PE_AUTODOC_LOWERED_HP:415,PE_AUTODOC_LOWERED_HP_II:416,PE_EXPERT_EXCREMENT:417,PE_JINXED_II:419,PE_TERMINATOR:420,PE_IRON_MAN:421,PE_PRO_UDAR:422,PE_ADD_ATAC:423,PE_NAPROLOM:424,PE_ADW_MET:425,PE_DERMAL_IMPACT:432},function(t){"use strict";var s,a=t.Base64;if("undefined"!=typeof module&&module.exports)try{s=require("buffer").Buffer}catch(t){}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=function(t){for(var s={},a=0,r=t.length;a<r;a++)s[t.charAt(a)]=a;return s}(r),i=String.fromCharCode,n=function(t){if(t.length<2)return(s=t.charCodeAt(0))<128?t:s<2048?i(192|s>>>6)+i(128|63&s):i(224|s>>>12&15)+i(128|s>>>6&63)+i(128|63&s);var s=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return i(240|s>>>18&7)+i(128|s>>>12&63)+i(128|s>>>6&63)+i(128|63&s)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(l,n)},o=function(t){var s=[0,2,1][t.length%3],a=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[r.charAt(a>>>18),r.charAt(a>>>12&63),s>=2?"=":r.charAt(a>>>6&63),s>=1?"=":r.charAt(63&a)].join("")},d=t.btoa?function(s){return t.btoa(s)}:function(t){return t.replace(/[\s\S]{1,3}/g,o)},p=s?function(t){return(t.constructor===s.constructor?t:new s(t)).toString("base64")}:function(t){return d(c(t))},u=function(t,s){return s?p(String(t)).replace(/[+\/]/g,(function(t){return"+"==t?"-":"_"})).replace(/=/g,""):p(String(t))},h=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),f=function(t){switch(t.length){case 4:var s=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return i(55296+(s>>>10))+i(56320+(1023&s));case 3:return i((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return i((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},m=function(t){return t.replace(h,f)},k=function(t){var s=t.length,a=s%4,r=(s>0?e[t.charAt(0)]<<18:0)|(s>1?e[t.charAt(1)]<<12:0)|(s>2?e[t.charAt(2)]<<6:0)|(s>3?e[t.charAt(3)]:0),n=[i(r>>>16),i(r>>>8&255),i(255&r)];return n.length-=[0,0,2,1][a],n.join("")},E=t.atob?function(s){return t.atob(s)}:function(t){return t.replace(/[\s\S]{1,4}/g,k)},_=s?function(t){return(t.constructor===s.constructor?t:new s(t,"base64")).toString()}:function(t){return m(E(t))},A=function(t){return _(String(t).replace(/[-_]/g,(function(t){return"-"==t?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))};if(t.Base64={VERSION:"2.1.9",atob:E,btoa:d,fromBase64:A,toBase64:u,utob:c,encode:u,encodeURI:function(t){return u(t,!0)},btou:m,decode:A,noConflict:function(){var s=t.Base64;return t.Base64=a,s}},"function"==typeof Object.defineProperty){var y=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",y((function(){return A(this)}))),Object.defineProperty(String.prototype,"toBase64",y((function(t){return u(this,t)}))),Object.defineProperty(String.prototype,"toBase64URI",y((function(){return u(this,!0)})))}}t.Meteor&&(Base64=t.Base64)}(this);var perk={PE_BONUS_HTH_ATTACKS:["Доп. рукопашн. атаки","Вы знакомы с тайными боевыми искусствами востока, и очень быстро дерётесь. Ваши рукопашные атаки занимают на 1 Очко Действия меньше.",1,15,29,function(){},function(){},{stats:{AGI:6}}],PE_BONUS_HTH_DAMAGE:["Доп. рукопашн. повр.","Большой опыт рукопашных схваток научил вас уделять внимание наносимым повреждениям. За каждый уровень этой способности вы получаете +3 к Рукопашным повреждениям.",3,32,99,function(){pr.add("feats","mdmg",3)},function(){pr.add("feats","mdmg",-3)},{stats:{AGI:6,STR:6}}],PE_BONUS_MOVE:["Бонус движения","За каждый уровень этой способности, раз в 10 секунд вы можете восполнить 1 Очко Действия.",1,2,29,function(){},function(){},{stats:{AGI:3}}],PE_BONUS_RANGED_DAMAGE:["Бонус точности","Ваши тренировки в обращении со стрелковым оружием сделали свое дело. Выстрелы очередью приносят больше урона((15+Удача*2)%).",1,6,29,function(){},function(){},{stats:{LUC:4}}],PE_BONUS_RATE_OF_FIRE:["Бонус скорости","Вы нажимаете на курок немного быстрее. Время, расходуемое на неприцельную атаку меньше на 1 ОД. Данная способность не распространяется на класс Инженерного оружия.",1,15,29,function(){},function(){},{stats:{AGI:7,INT:6,PER:6}}],PE_EARLIER_SEQUENCE:["Быстрая реакция","Враги всегда будут ошибаться, ведь прав тот, кто выстрелил первым. Поэтому ваш Порядок действий увеличивается на 4 с каждым уровнем этой способности.",2,2,29,function(){pr.add("feats","proc",4)},function(){pr.add("feats","proc",-4)},{stats:{PER:7}}],PE_FASTER_HEALING:["Быстрое лечение","Вы получаете +15 к Уровню лечения, таким образом, ваши раны быстрее заживают. Восстановление 1/4 максимальных ОД при исцелении Санитаром. Использование препаратов на 200мс быстрей.",1,6,29,function(){pr.add("feats","levh",3*stats.CHA[2])},function(){pr.add("feats","levh",3*-stats.CHA[2])},{stats:{ENU:8}}],PE_MORE_CRITICALS:["Больше крит. атак","Вероятность нанесения Критических повреждений противнику увеличена на 10%.",1,2,29,function(){pr.add("feats","crit",10)},function(){pr.add("feats","crit",-10)},{stats:{PER:6}}],PE_NIGHT_VISION:["Иммунитет","У васс очень высокий иммунитет. Из конечного урона по вам вычитается величина вашей природной Силы.",1,12,29,function(){},function(){},{stats:{STR:6,INT:8}}],PE_PRESENCE:["Охранник","Вы находитесь в своем городе, а дома и стены помогают. Вы получаете +4% ко всем Резистам.",1,1,1,function(){for(var t in resist)pr.addr(t,0,4)},function(){for(var t in resist)pr.addr(t,0,-4)},{}],PE_RAD_RESISTANCE:["Уст. к радиации","Вы лучше переносите сильное воздействие радиации на организм. Каждый уровень этой способности добавляет +10% к Устойчивости к радиации.",2,33,99,function(){pr.add("feats","srad",10)},function(){pr.add("feats","srad",-10)},{stats:{ENU:6,INT:4}}],PE_TOUGHNESS:["Крутизна","Крутизна позволяет чувствовать себя под защитой. Вы получаете +2 к трешхолдам, +5% к резистам Нормы и Огня.",1,6,29,function(){pr.addr("normal",2,0),pr.addr("fire",2,0),pr.addr("laser",2,0)},function(){pr.addr("normal",-2,0),pr.addr("fire",-2,0),pr.addr("laser",-2,0)},{stats:{STR:8}}],PE_STRONG_BACK:["Переноска","Прибавляет 100 кг к Максимальному весу и +50% к Атлетизму. Дает отдельный шанс 33% избежать опрокидывания.",1,2,29,function(){pr.add("feats","maxl",100),pr.add("skills","speed",50,1)},function(){pr.add("feats","maxl",-100),pr.add("skills","speed",-50,1)},{stats:{STR:6,ENU:6}}],PE_SHARPSHOOTER:["Меткость","Искусство попадать в цель с большого расстояния. +2 к восприятию если оно меньше 4. При определении дистанции вы получаете +2 к Восприятию и +6 к Дальности обзора.",1,6,29,function(){pr.add("feats","oview",6),stats.PER[2]<4&&(mychar.stats.PER[1]+=2)},function(){pr.add("feats","oview",-6),mychar.stats.PER[1]>=2&&(mychar.stats.PER[1]-=2)},{stats:{INT:6,PER:1}}],PE_SILENT_RUNNING:["Бесшумный бег","Теперь вы будете двигаться быстро, не издавая больше шума. Ранее это было совершенно неосуществимо в силу технических причин. Несовместим с уберперками.",1,9,29,function(){},function(){},{perks:{PE_SNIPER:1,PE_TERMINATOR:1,PE_ATTACK:1}}],PE_SURVIVALIST:["Исследователь","Привычка к долгой жизни в пустыне выработала у вас невероятную живучесть. С каждым уровнем этой способности вы получаете +10% к навыку Скиталец.",3,32,99,function(){pr.add("skills","ranger",10,1)},function(){pr.add("skills","ranger",-10,1)},{stats:{ENU:6,INT:6},skills:{ranger:40}}],PE_MASTER_TRADER:["Торговля","Вы стараетесь покупать товары по низким ценам, торгуясь до изнеможения. Вам даётся 25% скидка при покупке товаров.",1,32,99,function(){},function(){},{skills:{trade:200}}],PE_EDUCATED:["Образование","У вас отличное образование. Вы получаете +50 очков распределения.",1,2,29,function(){charp.points+=50},function(){},{}],PE_HEALER:["Лечение","Вы получаете +55 ОЖ к лечению санитаром. +5 ОЖ к лечению суперстимулятором.",1,6,29,function(){},function(){},{skills:{orderly:40}}],PE_FORTUNE_FINDER:["Воодушевление","Каждый Уворот от вражеской атаки прибавляет вам +1 ОД. Увеличивает Уворот на Ловкость*2%. Если ОЖ меньше трети от максимума, вы не получаете криты.",1,12,29,function(){pr.add("feats","dodge",2*stats.AGI[2])},function(){pr.add("feats","dodge",2*stats.AGI[2])},{stats:{AGI:6},perks:{PE_DODGER:0}}],PE_BETTER_CRITICALS:["Лучшие крит. атаки","Причиняемые вашему противнику Критические удары более смертоносны. Вы получаете (10+Удача)% бонус для возможных Крит. повреждений, хотя Вероятность их нанесения не увеличивается.",1,9,29,function(){},function(){},{stats:{PER:6,AGI:4}}],PE_EMPATHY:["Двуличный","Люди даже не подозревают, что может скрывать приятная внешность. Наносимые вами повреждения увеличиваются на 6 едениц.",1,6,29,function(){},function(){},{stats:{CHA:6}}],PE_SLAYER:["Дробила","Все атаки ближнего боя (рукопашная и холодное оружие) - критические (100% шанс на критический урон в ближнем бою). +10% антикрита.",1,15,29,function(){pr.add("feats","acrit",10)},function(){pr.add("feats","acrit",-10)},{stats:{AGI:6,STR:7},skills:{melee:100},perks:{PE_CHAT_OPERATOR:1},traits:{TRAIT_GOOD_NATURED:1}}],PE_SNIPER:["Снайпер","Шанс нанести Крит увеличивается на 40%. -1 ОД на прицельный выстрел.",1,15,29,function(){pr.add("feats","crit",40)},function(){pr.add("feats","crit",-40)},{traits:{TRAIT_GOOD_NATURED:1,TRAIT_SKILLED:1},perks:{PE_SILENT_RUNNING:1,PE_ATTACK:1,PE_TERMINATOR:1,PE_FIRESHOOT:1,PE_FISTRAGE:1}}],PE_SILENT_DEATH:["Хитрость","Вы хитры в своих действиях. +30 ОЖ, +5% к Увороту, +50% к Атлетизму.",1,9,29,function(){pr.add("feats","live",30),pr.add("feats","dodge",5),pr.add("skills","speed",50,1)},function(){pr.add("feats","live",-30),pr.add("feats","dodge",-5),pr.add("skills","speed",-50,1)},{traits:{TRAIT_HEAVY_HANDED:0}}],PE_ACTION_BOY:["Человек действия","Человек действия все операции совершает бегом, наподобие новобранца. Это придает ему дополнительных 2 Очка Действия, которые можно использовать в любых целях.",1,9,29,function(){pr.add("feats","apoi",2)},function(){pr.add("feats","apoi",-2)},{feats:{proc:20},skills:{steal:150},stats:{AGI:6},traits:{TRAIT_HEAVY_HANDED:1}}],PE_MENTAL_BLOCK:["Мастер","Вы отлично знаете, как усовершенствовать боеприпасы. Они пролучают -5 к резисту противника. С вероятностью Удача% вызовут Боль (-1Од, 25% Подавления). Работает и на погекс (где есть заряды у оружия).",1,9,29,function(){},function(){},{skills:{traps:160}}],PE_LIFEGIVER:["Сила жизни","Вы получаете дополнительно +60 Очков жизней. Xоть это и немного, всякое случается, а вдруг пригодится.",1,15,29,function(){pr.add("feats","live",60)},function(){pr.add("feats","live",-60)},{stats:{ENU:4}}],PE_DODGER:["Увертливость","Во время боя в вас будет гораздо сложнее попасть. Независимо от одетых на вас в этот момент доспехов, и 7% к Увороту.",1,9,29,function(){pr.add("feats","dodge",7)},function(){pr.add("feats","dodge",-7)},{stats:{LUC:3}}],PE_SNAKEATER:["Змееглот","Любые отравляющие вещества действуют на вас крайне ослаблено. Каждый уровень этой способности добавляет +10% к Устойчивости к яду.",2,32,99,function(){pr.add("feats","stox",10)},function(){pr.add("feats","stox",-10)},{stats:{ENU:3}}],PE_MR_FIXIT:["Самоделкин","Данная способность дает вам бонус к навыкам Наука 20% и Ремонт на 10%, а также возможность определять количество поломок амуниции.",1,2,32,function(){pr.add("skills","repair",10,1),pr.add("skills","science",20,1)},function(){pr.add("skills","repair",-10,1),pr.add("skills","science",-20,1)},{skills:{repair:40,science:40}}],PE_MEDIC:["Медик","Знание медицины дает вам бонус к навыкам Санитар и Доктор на 10%. Хорошее лечение - залог успеха.",1,2,32,function(){pr.add("skills","orderly",10,1),pr.add("skills","doctor",10,1)},function(){pr.add("skills","orderly",-10,1),pr.add("skills","doctor",-10,1)},{skills:{orderly:40,doctor:40}}],PE_MASTER_THIEF:["Вор-профессионал","+40 Воровства и Взлом замков. У вас не ломаются отмычки при взломе. Регенерация в снике каждые 10 сек. Вы не выходите из скрытности при использовании навыков, атаке по вам или работы с инвентарем. При воровстве 200 можно открывать ящики монтировкой.",1,9,29,function(){pr.add("skills","steal",40,1),pr.add("skills","hack",40,1)},function(){pr.add("skills","steal",-40,1),pr.add("skills","hack",-40,1)},{skills:{hack:150}}],PE_SPEAKER:["Болтливость","Болтун - находка для врага! С каждым уровнем этой способности вы получаете +10% к навыку Красноречие.",1,32,99,function(){pr.add("skills","oratory",10,1)},function(){pr.add("skills","oratory",-10,1)},{stats:{INT:4}}],PE_HEAVE_HO:["Эволюция","Если попавший в вас игрок имеет больше жизней и у вас нет кд Доктора, вы получаете 1 Од и +2 сек кд дока-, если этот игрок у вас не в Стеке. .",1,6,29,function(){},function(){},{stats:{AGI:7}}],PE_FRIENDLY_FOE:["Фанат дробовиков","Вас с детства тянет к дробовикам (+30% к Легкому оружию, +20% к Ремонту). При выстреле с дробовика, при очереди, добавляется +4 к каждой пуле, при одиночном +10 к конечному урону.",1,6,29,function(){pr.add("skills","light",30,1),pr.add("skills","repair",20,1)},function(){pr.add("skills","light",-30,1),pr.add("skills","repair",-20,1)},{stats:{INT:6},skills:{light:160}}],PE_PICKPOCKET:["Карманник","Ваши способности шарить по чужим карманам увеличиваются. Теперь вы можете не обращать внимание на направление взгляда и размер одежды вашего клиента.",1,32,99,function(){},function(){},{stats:{AGI:8},skills:{steal:80}}],PE_GHOST:["Привидение","Вы научились быть более незаметным, словно призрак. Вы восполняете 1 ОД раз в 10 секунд. Также получаете +40% к Скрытности.",1,6,29,function(){pr.add("skills","sneak",40,1)},function(){pr.add("skills","sneak",-40,1)},{}],PE_CULT_OF_PERSONALITY:["Отличник","Вы отлично учились и многое усвоили. +5% к резистам от типов урона Плазма, Лазер, Электричество. Дает иммунитет к сжиганию ОД.",1,1,1,function(){pr.addr("laser",0,5),pr.addr("plasma",0,5),pr.addr("electro",0,5)},function(){pr.addr("laser",0,-5),pr.addr("plasma",0,-5),pr.addr("electro",0,-5)},{stats:{PER:7}}],PE_SCROUNGER:["Полевой медик","Вы обладаете огромными знаниями по медицине. +30% к навыку Санитар, +30% к навыку Доктор. +3 Удачи при лечении навыком Санитар. -2 сек. кд. санитара если вы лечите другого или другой вас. ",1,9,29,function(){pr.add("skills","orderly",30,1),pr.add("skills","doctor",30,1)},function(){pr.add("skills","orderly",-30,1),pr.add("skills","doctor",-30,1)},{skills:{orderly:120,doctor:100}}],PE_EXPLORER:["Непоседа","Смысл жизни непоседы заключается в поисках новых, интересных мест. Ваши шансы найти нечто необычное увеличиваются, как и Очки жизней (Сила*5).",1,6,29,function(){pr.add("feats","live",5*stats.STR[2])},function(){pr.add("feats","live",5*-stats.STR[2])},{}],PE_FLOWER_CHILD:["Полевой санитар","Восстановление навыка Санитар меньше на 4 секунды. При лечении санитаром добавляются (ИН+УД)*3 дополнительные ОЖ, а также можно восстановить все ОЖ с шансом (Удача*3).",1,6,29,function(){},function(){},{skills:{orderly:60,doctor:40}}],PE_PATHFINDER:["Следопыт","Следопыт всегда находит кратчайший путь до места назначения. С этим бонусом время ваших переходов по Глобальной Карте уменьшено на 25%.",1,2,32,function(){},function(){},{stats:{ENU:6},skills:{ranger:40}}],PE_ANIMAL_FRIEND:["Удачный промах","+1 Очко Действия. (Удача)% шанс восстановить (Точность атакующего/10)ОД при промахе по вам или увороте. Если шанс не выпал вы восстановите 1 ОД.",1,12,29,function(){pr.add("feats","apoi",1)},function(){pr.add("feats","apoi",-1)},{stats:{PER:6,LUC:2}}],PE_SCOUT:["Скаут","Увеличивает на одну клетку радиус трекинга и открытия черных клеток Глобальной Карты. Увеличивает шанс найти уникальную локацию.",1,32,99,function(){},function(){},{stats:{ENU:8}}],PE_MYSTERIOUS_STRANGER:["Ветеран","Жизненный опыт дает вам +30 ОЖ. Ваша меткость при прицельной атаке максимальная и каждое попадание вешает усталость на цель. +10 Класса Брони.",1,12,29,function(){pr.add("feats","live",30),pr.add("proc","armc",8)},function(){pr.add("feats","live",-30),pr.add("proc","armc",8)},{stats:{LUC:2}}],PE_RANGER:["Рейнджер","Ваш навык Скиталец повышается на 15%. Увеличивается вероятность избежать встреч в пустыне или наоборот - отыскать там что-то полезное.",1,32,99,function(){pr.add("skills","ranger",15,1)},function(){pr.add("skills","ranger",-15,1)},{stats:{PER:6}}],PE_QUICK_POCKETS:["Оптимизация","Ваши вещи всегда под рукой. -1 ОД на перезарядку. 40% шанс получить 1 ОД при перезарядке. 25% шанс получить 1 Од при использовании предметов.",1,2,29,function(){},function(){},{stats:{AGI:5}}],PE_SMOOTH_TALKER:["Опыт торговли","Ваш опыт торговли (0-300). При малом опыте вы все равно будете покупать дорого. Опыт торговли не может превышать ваш навык Торговли.",1,1,1,function(){},function(){},{}],PE_SWIFT_LEARNER:["Самоучка","Вы можете извлекать из всего большую пользу, чем кто-либо другой. С каждым уровнем этой способности вы получаете на 15% больше опыта.",3,2,29,function(){},function(){},{stats:{INT:6}}],PE_TAG:["Математик","Вы все досконально просчитываете. В бою вы получаете +30 к используемому навыку и уменьшаете штраф от дыма на 10, а укрытий на 10. В то же время получая +10 к укрытиям и +10 к дыму когда вы атакованы.",1,12,29,function(){},function(){},{stats:{INT:7,LUC:2},skills:{science:200}}],PE_MUTATE:["Мутация","Радиация пустыни изменила вас! Вы получаете +20 Очков жизней и +100 очков распределения.",1,12,29,function(){pr.add("feats","live",20),charp.points+=100},function(){pr.add("feats","live",-20)},{stats:{STR:3,ENU:5}}],PE_BOOKWORM:["Регенерация","Восстановление ОЖ от Уровня лечения становится полноценным, +25 к Уровню лечения. Лечит конечности во время тика раз в 10 секунд, если персонаж не в бою.",1,12,29,function(){pr.add("feats","levh",25)},function(){pr.add("feats","levh",-25)},{stats:{CHA:5,INT:6}}],PE_AWARENESS:["Осведомленность","Вы замечаете больше деталей в окружающем вас мире и людях. Можно увидеть количество Очков здоровья у противника. При выстреле по нему узнать его антикрит и уворот (нужно включить режим ~hitlook, введя его в чат).",1,2,29,function(){},function(){},{stats:{PER:5}}],PE_BIVALIY:["Крепкий Орешек","Вы можете ослабить критический урон и эффект по вам. -((ВС*3)+СЛ) к Критроллу. Резка критурона зависит от Силы, Удачи и Интеллекта. Режет критурон Нокаута и Пропуска хода с 75% до 50% и с 50% до 30% соответственно.",1,12,29,function(){},function(){},{}],PE_PALESKIN:["Эгоист","Вы выходите из боя при применении навыка Санитар, если не отравлены и не облучены.",1,2,29,function(){},function(){},{stats:{CHA:5}}],PE_GECKON:["Ящерица","У вас была терминальная стадия рака и единственным выходом было нетрадиционное лечение. Никто не знал, что инъекции стволовых клеток ящерицы обернутся таким приятным сюрпризом. Входящий по вам урон свыше 65 ед. с вероятностью 50% восстановит Сила*2 ОЖ.",1,9,29,function(){},function(){},{stats:{STR:7}}],PE_GUY:["Крутой парень","Игнорирование требования Силы на дальность метания. Ваша атака по сопернику имеет шанс сжечь ему 3 Од. Сжигание ОД работает на погексовые атаки. Шанс(Порядок>Рандом(0,ПорядокПротивника+100)). Игнор бонусов жертвы на срез урона при атаке в небоевом режиме.",1,9,29,function(){},function(){},{}],PE_BIGSKIN:["Горячая кровь","Вы настолько горячи и импульсивны, что игнорируете эффект Контузии (кроме крита) и критические промахи. На вашу точность не влияют укрытия. ",1,6,29,function(){},function(){},{stats:{PER:7},traits:{TRAIT_JINXED:1}}],PE_MASTERMELE:["Мастер ближнего боя","При атаке рукопашным или холодным оружием к вашему урону добавляется рандомное значение вашей Силы.",1,2,29,function(){},function(){},{stats:{AGI:6}}],PE_COWBOY:["Ковбой","Все бонусы действуют только для огнестрельных пистолетов. Прицельные атаки вернут 1 од (если нет перка Снайпер). Шанс крита +5%. Если не в бою, то выстрел обнуляет патроны цели  в магазине. Исключает Бесшумный бег.",1,6,29,function(){pr.add("feats","crit",5)},function(){pr.add("feats","crit",-5)},{skills:{light:180},stats:{AGI:8},perks:{PE_SNIPER:1,PE_FIRESHOOT:1}}],PE_FISTRAGE:["Критическое мышление","Каждый выстрел увеличивает на 10% критшанс вплоть до 30%. После выпадении крита он обнуляется.",1,12,29,function(){},function(){},{perks:{PE_SNIPER:1}}],PE_ADEPTGLOW:["Партизанская граната","Годы, проведенные в партизанском отряде, не прошли для вас даром. +10 к урону от всех гранат, а также при стрельбе из ручного гранатомёта с шансом (ОД на бросок гранаты)10% вам вернётся 1 ОД.",1,9,29,function(){},function(){},{skills:{thrown:180},stats:{STR:8}}],PE_FANAT:["Разгрузка","У вас встроенная разгрузка. Вы можете использовать предметы затрачивая на 1 Очко действия меньше.",1,1,1,function(){},function(){},{}],PE_STOIK:["Железный человек","Урон по вам срезается по формуле (ВЫН+ИНТ+ХАР)*1.5. Не срезается урон от критов. Взаимоисключение с любыми перками на уворот.",1,1,1,function(){},function(){},{}],PE_CRITTER:["Концентрация","Вы получаете -1 очко действия на прицельные выстрелы.",1,15,29,function(){},function(){},{stats:{LUC:3},perks:{PE_SILENT_RUNNING:1}}],PE_TARGETING:["Стиляга","Стиль – ваше второе имя: вы выглядите неотразимо даже в лохмотьях, а вашим солнцезащитным очкам завидуют всё модники пустоши. Вы никогда не ловите эффект «Контузия» (белый экран). Скорость износа вашей брони замедляется в 4 раза. Иммунитет к черному экрану.",1,2,29,function(){},function(){},{stats:{CHA:5}}],PE_AVTORITET:["Авторитет","Если нанести урон взрывом, а потом выпустить урон очередью с 1-3 гексов, то цель получит эффект Ошарашен (с вероятностью (11+Удача-УдачаЦели)*4%).В этом эффекте цель не может применять предметы и стрелять(включается паника) и входящий урон увеличен на 25%. Эффект проходит через количество секунд равное Удаче атакера.",1,15,29,function(){},function(){},{perks:{PE_SILENT_RUNNING:1}}],PE_RAGE:["Зарядка","Привычка заниматься зарядкой по утрам, выработалась у вас давно. С каждым уровнем этой способности ваши Очки здоровья возрастают на 5 единицы.",1,32,99,function(){pr.add("feats","live",5)},function(){pr.add("feats","live",-5)},{perks:{PE_HARD:1}}],PE_DEFENCE:["Рефлексы","Ваши рефлексы повышены и неприцельно вы стреляете быстрее. -1 ОД на не прицельный выстрел. Нельзя взять Снайпера и Быстрого стрелка. Не работает с инженерным оружием.",1,12,29,function(){},function(){},{stats:{PER:5,ENU:8},perks:{PE_SNIPER:1},traits:{TRAIT_FAST_SHOT:1}}],PE_ATTACK:["Неудержимый","Вы неудержимы как... Да вас хрен остановишь! Вы получаете +ЛВ/2-1 ОД и +7% к регену ОД. +5 к конечному урону Уберперк.",1,15,29,function(){pr.add("feats","apoi",Math.floor(stats.AGI[2]/2-1))},function(){pr.add("feats","apoi",-Math.floor(stats.AGI[2]/2-1))},{traits:{TRAIT_GOOD_NATURED:1,TRAIT_SKILLED:1},perks:{PE_SILENT_RUNNING:1,PE_SNIPER:1,PE_TERMINATOR:1}}],PE_HARD:["Закалка","Ваш организм подготовлен к быстрому лечению в сложных условиях. С каждым уровнем этой способности ваш Уровень лечения возрастает на 6 единиц.",1,32,99,function(){pr.add("feats","levh",6)},function(){pr.add("feats","levh",-6)},{perks:{PE_RAGE:1}}],PE_VIEW:["Репликант","Репликация снимает все эффекты, а также становится бесплатной.",1,9,32,function(){},function(){},{stats:{STR:4}}],PE_TRAPPER:["Цепной пёс","Пули вас так просто не остановят. Если до противника меньше 16 гексов, то вы получаете (15-дистанция)% к увороту против его дистанционных атак, но не более 25%",1,6,29,function(){},function(){},{skills:{melee:160,steel:160},ormode:{skills:{melee:160,steel:160}}}],PE_RAZVEDKA:["Глаза и уши","Вы получаете +2 Восприятию.",1,9,29,function(){mychar.stats.PER[1]+=2},function(){mychar.stats.PER[1]-=2},{}],PE_GOLEM:["Голем","На персонаже не срабатывают растяжки и мины.",1,2,29,function(){},function(){},{stats:{CHA:4}}],PE_RAGEBER:["Ярость","Яростный удар валит противника на пол, добавляет 8 к урону и снимает 1 ОД. Кд удара 10 секунд. +10 к критроллу",1,6,29,function(){},function(){},{skills:{melee:200}}],PE_ARMOR:["Оборотень","Если по вам стреляет игрок не из вашего Стека то он наносит на 4 повреждения меньше. Если же вы стреляете по игроку, у которого вы в Стеке, вы наносите на 5 повреждения больше.",1,6,29,function(){},function(){},{stats:{CHA:2}}],PE_ADRENALINE_RUSH:["Кровопийца","Обстоятельно изучив кровь, вы получаете +25 ОЖ. Также каждая атака по цели восстановит (ВС+4) Очков здоровья. При использовании навыка Санитар, вы снимаете с себя эффект Нагрева.",1,12,29,function(){pr.add("feats","live",25)},function(){pr.add("feats","live",-25)},{skills:{orderly:200},stats:{ENU:7}}],PE_CAUTIOUS_NATURE:["Бдительность","Вы бдительны и настойчивы. Ваш Обзор увеличивается, а при определении положения на местности, ваше Восприятие +3 единицы. +1 ОД при промахе.",1,2,29,function(){pr.add("feats","oview",3)},function(){pr.add("feats","oview",-3)},{stats:{PER:6}}],PE_COMPREHENSION:["Наблюдательность","При чтении вы обращаете особенное внимание на мелкие детали (+1 Интеллект). Читая книгу, вы получаете +1% к случайному Навыку, а также +200 опыта.",1,2,29,function(){mychar.stats.INT[1]++},function(){mychar.stats.INT[1]--},{ch:!0,stats:{INT:7}}],PE_DEMOLITION_EXPERT:["Эксперт подрывник","В обращении со взрывчаткой, вы настоящий профессионал. Ваши заряды всегда детонируют вовремя, имеют большой радиус и наносят больше урона.",1,33,99,function(){},function(){},{stats:{AGI:4},skills:{traps:75}}],PE_GAMBLER:["Атлет","Быстрее! Выше! Сильнее! Усиленные тренировки не проходят даром. +50% к навыку Атлетизм. -2 секунды выхода из боя.",1,6,29,function(){pr.add("skills","speed",50,1)},function(){pr.add("skills","speed",-50,1)},{skills:{speed:50}}],PE_GAIN_STRENGTH:["Получить силу","Этот бонус повышает на одно очко вашу Силу и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.STR[1]++,pr.add("feats","live",20)},function(){mychar.stats.STR[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{STR:10}}],PE_GAIN_PERCEPTION:["Получить восприятие","Этот бонус повышает на одно очко ваше Восприятие и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.PER[1]++,pr.add("feats","live",20)},function(){mychar.stats.PER[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{PER:10}}],PE_GAIN_ENDURANCE:["Получить выносливость","Этот бонус повышает на одно очко вашу Выносливость и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.ENU[1]++,pr.add("feats","live",20)},function(){mychar.stats.ENU[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{ENU:10}}],PE_GAIN_CHARISMA:["Получить харизму","Этот бонус повышает на одно очко вашу Харизму и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.CHA[1]++,pr.add("feats","live",20)},function(){mychar.stats.CHA[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{CHA:10}}],PE_GAIN_INTELLIGENCE:["Получить интеллект","Этот бонус повышает на одно очко ваш Интеллект и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.INT[1]++,pr.add("feats","live",20)},function(){mychar.stats.INT[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{INT:10}}],PE_GAIN_AGILITY:["Получить ловкость","Этот бонус повышает на одно очко вашу Ловкость и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.AGI[1]++,pr.add("feats","live",20)},function(){mychar.stats.AGI[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{AGI:10}}],PE_GAIN_LUCK:["Получить удачу","Этот бонус повышает на одно очко вашу Удачу и добавляет +20 Очков жизней.",1,6,29,function(){mychar.stats.LUC[1]++,pr.add("feats","live",20)},function(){mychar.stats.LUC[1]--,pr.add("feats","live",-20)},{ch:!0,stats:{LUC:10}}],PE_HARMLESS:["Безвредность","Ваш невинный вид позволяет вам успешно красть у людей вещи. Вы получаете +40% к навыку Воровство.",1,32,99,function(){pr.add("skills","steal",40,1)},function(){pr.add("skills","steal",-40,1)},{skills:{steal:50}}],PE_HERE_AND_NOW:["Специалист","Вы набрались ума и получаете одно очко распределения.",15,32,99,function(){charp.points+=1},function(){},{}],PE_HTH_EVADE:["Верткость","Вы чувствуете, когда надо дернуться с места, природная ловкость помогает вам в этом. Процент Уклонения от атаки увеличивается на Текущие ОД.",1,6,29,function(){},function(){},{stats:{LUC:5},perks:{PE_DODGER:1}}],PE_KAMA_SUTRA_MASTER:["Спортсмен","Занятия активными видами спорта не прошли даром. Вы получаете +45 Очков жизней и +10 к Классу Брони.",1,12,29,function(){pr.add("feats","live",45),pr.add("feats","armc",10)},function(){pr.add("feats","live",-45),pr.add("feats","armc",-10)},{stats:{STR:8}}],PE_KARMA_BEACON:["Исполнительность","Вы выполнили ежедневное задание и получаете бонус 20 единиц к Очкам жизней.",1,1,1,function(){pr.add("feats","live",20)},function(){pr.add("feats","live",-20)},{}],PE_LIGHT_STEP:["Легкие шаги","Вы ловки, удачливы и всегда настороже. 50%, что ловушка на вас сработает. Урон от ловушек снижен на 50%. +15% к Резисту от Взрыва, +5 к Трешхолду Огня.",1,6,29,function(){pr.addr("explode",0,15),pr.addr("fire",5,0)},function(){pr.addr("explode",0,-15),pr.addr("fire",-5,0)},{stats:{AGI:5}}],PE_LIVING_ANATOMY:["Анатомия жизни","Вы хорошо представляете себе внутреннее строение живых существ, их силы и слабости. При атаке вы наносите на 10 Урона больше. Кроме того, вы получаете +20% к навыку Доктор.",1,15,29,function(){pr.add("skills","doctor",20,1)},function(){pr.add("skills","doctor",-20,1)},{stats:{PER:7},skills:{doctor:80}}],PE_MAGNETIC_PERSONALITY:["Привлекательность","Игрок может водить с собой в группе дополнительно 2-х человек без проверки на Харизму, но не забывайте, что больше пяти - это уже толпа.",1,32,99,function(){},function(){},{ch:!0,stats:{CHA:10}}],PE_NEGOTIATOR:["Негоциант","С этим умением вы можете попробовать договориться до чего угодно, имея бонус 20% к навыкам Торговля и Красноречие.",1,32,99,function(){pr.add("skills","oratory",20,1),pr.add("skills","trade",20,1)},function(){pr.add("skills","oratory",-20,1),pr.add("skills","trade",-20,1)},{skills:{trade:200}}],PE_PACK_RAT:["Запаковка","Вы научились компактно раскладывать вещи в инвентаре. +22.65 кг к Максимальному весу.",1,32,99,function(){pr.add("feats","maxl",22)},function(){pr.add("feats","maxl",-22)},{}],PE_PYROMANIAC:["Пироманьяк","Вы отлично управляетесь с огнем. Если тип повреждений - огонь, то: +20 бонусного урона, +15 к тика огня. 50% защиты от тиков огня.",1,9,29,function(){},function(){},{stats:{INT:4}}],PE_QUICK_RECOVERY:["Прыгучесть","Вы очень быстро встаете после того, как вас собьют с ног. Реакция и гибкость добавляют вам 1 Очко Действия. Несовместим с Человеком Действия.",1,6,29,function(){pr.add("feats","apoi",1)},function(){pr.add("feats","apoi",-1)},{stats:{AGI:5}}],PE_SALESMAN:["Продажа","Вы умеете отлично продавать и покупать. С этой способностью вы на 40% повышаете свой навык Торговля.",1,32,99,function(){pr.add("skills","trade",40,1)},function(){pr.add("skills","trade",-40,1)},{skills:{trade:240}}],PE_STONEWALL:["Человек-глыба","Первая тычка вводящая в бой наносит вдвое меньше урона. Не действует на погекс. +75% шанс игнорировать опрокидывание, Не может выронить оружие/нельзя выбить оружие",1,6,29,function(){},function(){},{stats:{STR:6}}],PE_THIEF:["Вор","В ваших жилах течет кровь истинного вора. Вы повышаете на 25% свои навыки Взлом замков, Воровство, Ловушки, а также на 10% навык Скрытность.",1,2,32,function(){pr.add("skills","sneak",10,1),pr.add("skills","hack",25,1),pr.add("skills","steal",25,1),pr.add("skills","traps",25,1)},function(){pr.add("skills","sneak",-10,1),pr.add("skills","hack",-25,1),pr.add("skills","steal",-25,1),pr.add("skills","traps",-25,1)},{}],PE_WEAPON_HANDLING:["Обращение с оружием","Вы можете носить и использовать оружие мощнее, чем остальные. Для этой цели ваша Сила считается на 3 единицы больше.",1,2,32,function(){},function(){},{stats:{AGI:5}}],PE_VAULT_CITY_INOCULATIONS:["Спартак","Вы истинный мастер копья, ваши удары копьем игнорируют резисты и трешхолды цели (но не бонусную защиту перков и трейтов)",1,6,29,function(){},function(){},{skills:{steel:150},stats:{STR:7}}],PE_VAULT_CITY_TRAINING:["Стажировка в Городе-Убежище","Вы прошли курс обучения медицине у лучших специалистов Города-Убежище.",1,1,1,function(){},function(){},{}],PE_EXPERT_EXCREMENT:["Спец по уборке экскрементов","Вы научились убирать дерьмо за браминами лучше, чем кто-либо.",1,1,1,function(){},function(){},{}],PE_EXPERT_MEDIC:["Опытный медик","При лечении санитара минимум лечения берется как среднее значение первоначального максимума и минимума лечения. Полный отхил союзника.",1,1,1,function(){},function(){},{skills:{doctor:80}}],PE_JINXED_II:["Старый вояка","На своём веку вы повидали многое, и вас так просто не сломить. +32% к антикриту.",1,12,29,function(){pr.add("feats","acrit",20)},function(){pr.add("feats","acrit",-20)},{perks:{PE_TERMINATOR:1}}],PE_TERMINATOR:["Терминатор","Ваш антикрит высчитывается по формуле (СИЛ+ВЫН)*5. Шанс вылечить свою сломанную конечность=100% вне зависимости от вашего навыка доктора. КД санитара вычисляется по формуле 7500/навык.",1,15,29,function(){},function(){},{stats:{STR:5,ENU:5},traits:{TRAIT_GOOD_NATURED:1,TRAIT_SKILLED:1},perks:{PE_SILENT_RUNNING:1,PE_ATTACK:1,PE_SNIPER:1,PE_JINXED_II:1}}],PE_IRON_MAN:["Взрывотехник","С этой способностью вы можете разминировать территорию в радиусе 1 гекс(Наука на себя), переключатели пластида действуют быстрей и есть возможность делать роботов-шахидов (детали робота+пластид).",1,9,29,function(){},function(){},{stats:{LUC:5},skills:{science:150,traps:200}}],PE_PRO_UDAR:["Токсиколог","Вы достигли небывалых высот в химии. Оружие с типом урона Норма(кроме очередей) наносит дополнительный урон отравлением.",1,9,29,function(){},function(){},{skills:{science:180}}],PE_ADD_ATAC:["Дополнительные атаки","Отдача от оружия никогда не была для вас проблемой. При выстреле с вероятностью в [25+ОД требуемые на выстрел*10]% есть шанс восстановить Очко Действия.",1,12,29,function(){},function(){},{stats:{AGI:7,INT:7}}],PE_NAPROLOM:["Бывалый","Вы знаток оружия. +7% к навыку Легкое, Тяжелое, Энергетическое оружие.",1,12,32,function(){pr.add("skills","light",7,1),pr.add("skills","heavy",7,1),pr.add("skills","energy",7,1)},function(){pr.add("skills","light",-7,1),pr.add("skills","heavy",-7,1),pr.add("skills","energy",-7,1)},{stats:{INT:6}}],PE_ADW_MET:["Карман","У вас карман стал глубже и можно добавить 1 веса.",15,32,99,function(){pr.add("feats","maxl",1)},function(){pr.add("feats","maxl",-1)},{}],PE_FISTSANITAR:["Военврач","Лечение Санитаром как при 10 Удачи. ",1,15,29,function(){},function(){},{stats:{INT:8},skills:{doctor:180}}],PE_LUCKDOC:["Флаг удачи","С вероятностью Удача%*1.5 книга даст двойной эффект, а тик регена может дать 99 очков жизней, если вы не на глобальной карте.",1,2,29,function(){},function(){},{stats:{LUC:5}}],PE_PRICEL:["Угнетение","В случае попадания по игроку, если его нет в вашем Стеке, вы наносите на Интеллект*2 повреждений больше.",1,1,1,function(){},function(){},{skills:{traps:150}}],PE_FIRESHOOT:["Прищур","Вы получаете 10% к шансу на крит, восстановление 1 од при прицельном выстреле.",1,9,29,function(){pr.add("feats","crit",10)},function(){pr.add("feats","crit",-10)},{stats:{LUC:3},perks:{PE_SNIPER:1,PE_FISTRAGE:1,PE_COWBOY:1}}],PE_GECKO_SKINNING:["Скорняк","Вы освоили принципы разделки ящеров и легко обдираете их, чтобы получить ценные шкуры.",1,1,1,function(){},function(){},{}],PE_DERMAL_IMPACT:["Живчик","Вы имеете повышенную живучесть (+40 ОЖ) и природное лечение (+15 к Уровню лечения).",1,12,29,function(){pr.add("feats","live",35),pr.add("feats","levh",3*stats.CHA[2])},function(){pr.add("feats","live",-35),pr.add("feats","levh",3*-stats.CHA[2])},{stats:{ENU:6}}],PE_DERMAL_IMPACT_ENH:["Улучшенная подкожная броня","Вы получили усиленную защиту от атак физического характера.",1,1,1,function(){pr.add("feats","live",10),pr.addr("normal",0,2),pr.addr("fire",0,3),pr.addr("explode",0,3)},function(){pr.add("feats","live",-10),pr.addr("normal",0,-2),pr.addr("fire",0,-3),pr.addr("explode",0,-3)},{}],PE_PHOENIX_IMPLANTS:["Реаниматор","Вы отличный врач. Любое изменение очков жизни (неважно, плюс или минус) добавит к ним 5 единицы жизней.",1,12,29,function(){},function(){},{skills:{doctor:230}}],PE_PHOENIX_IMPLANTS_ENH:["Улучшенная подкожная защита","Вы имеете большую дополнительную защиту против энергетических атак.",1,1,1,function(){pr.add("feats","live",10),pr.addr("plasma",0,3),pr.addr("electro",0,3),pr.addr("laser",0,3)},function(){pr.add("feats","live",-10),pr.addr("plasma",0,-3),pr.addr("electro",0,-3),pr.addr("laser",0,-3)},{}],PE_NCR_PERCEPTION:["Операция доктора Клауса: Крит","После операции, проведенной Доктором Клаусом из НКР, ваш шанс крита +4%.",1,1,1,function(){mychar.stats.PER[1]++},function(){mychar.stats.PER[1]--},{}],PE_NCR_ENDURANCE:["Операция доктора Клауса: Антикрит","После операции, проведенной Доктором Клаусом из НКР, ваша антикрит +4%.",1,1,1,function(){},function(){},{}],PE_NCR_BARTER:["Секреты мастерства: Бартер","Вы смогли многому научиться у торговца в Дене. Ваш навык Торговли повышен на 5%.",1,1,1,function(){pr.add("skills","trade",5,1)},function(){pr.add("skills","trade",-5,1)},{}],PE_NCR_REPAIR:["Секреты мастерства: Ремонт","Механик Модока ознакомил вас с новой технологией починки оружия. Ваш навык Ремонта повышен на 5%.",1,1,1,function(){pr.add("skills","repair",5,1)},function(){pr.add("skills","repair",-5,1)},{}],PE_COMPUSTER:["Золотые руки","Вам больше не понадобится установка для создания некоторых вещей. Открывает новые возможности в сфере крафта.",1,32,99,function(){},function(){},{stats:{INT:8,STR:8},skills:{science:160,repair:160}}],PE_DRIVER:["Водитель","Вы настолько освоили автомобиль, что можете возить в нём кого угодно.",1,1,1,function(){},function(){},{}],PE_OFFICER:["Офицер","Вы умеете управлять большим отрядом бойцов. Вы получаете +30 ОЖ, а также точность +5% и срез точности у противника -5%(так же 5% к точности и срезу точности получают и те, кто к вам присоединен). Используется выносливость при расчете группы. Подавление от оружия делится пополам.",1,15,29,function(){pr.add("feats","live",30)},function(){pr.add("feats","live",-30)},{stats:{PER:7,INT:7}}],PE_BISNES_RENO:["Смотрящий","Вы теперь один из смотрящих за бизнесом в Нью-Рено.",1,1,1,function(){pr.add("feats","live",30+(skills.oratory[0]>309?20:0))},function(){},{}],PE_SPEED:["Быстрота","Вам добавляется одно очко действия.",1,2,29,function(){pr.add("feats","apoi",1)},function(){pr.add("feats","apoi",-1)},{stats:{CHA:5}}],PE_IMP1:["Боевой имплантант","В вас вживлен экспериментальный имплантант. Ваши боевые навыки увеличены.",1,1,1,function(){},function(){},{}],PE_IMP2:["Медицинский имплантант","В вас вживлен экспериментальный имплантант. Ваши познания в медицине увеличены.",1,1,1,function(){},function(){},{}],PE_IMP3:["Вспомогательный имплант","В вас вживлен экспериментальный имплантант. Ваши вспомогательные функции увеличены.",1,1,1,function(){},function(){},{}],PE_COMBAT_ENGINEER:["Боевой Инженер","Вы настолько преуспели в инженерном деле, что теперь можете применять эти навыки в бою. Вы получаете +20% к навыку Ремонт и вам доступны особые виды вооружения.",1,12,29,function(){pr.add("skills","repair",20,1)},function(){pr.add("skills","repair",-20,1)},{stats:{PER:6,INT:6,AGI:3},skills:{repair:180}}],PE_CHAT_OPERATOR:["Пробивающий удар","Атаки рукопашным и холодным оружием получают к конечному урону 1/3 резиста цели ",1,12,29,function(){},function(){},{stats:{STR:10},skills:{steel:120},perks:{PE_SLAYER:1},traits:{TRAIT_HEAVY_HANDED:1}}],PE_DA_NORMAL:["Мастер урона","Вы освоили огнестрельное оружие, и наносите на 2% больше Урона по цели с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_DA_LASER:["Мастер лазера","Вы освоили лазерное оружие, и наносите на 1% больше Урона по цели с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_DA_FIRE:["Мастер огня","Вы освоили обращение с огнем, и получаете +2 к тикам с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_DA_PLASMA:["Мастер плазмы","Вы освоили плазменное оружие, и получаете +5 к тикам с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_DA_ELECTRO:["Мастер электричества","Вы освоили электро-оружие, и получаете шанс 4% уменьшить ОД врага на 1 единицу с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_DA_EMP:["Мастер импульса","Вы настолько освоили своё оружие, что наносите на 3% больше Урона с каждым уровнем этой способности.",1,1,1,function(){},function(){},{}],PE_DA_EXPLODE:["Мастер взрыва","Вы освоили все виды взрывов, и получаете шанс 10% увеличить Радиус взрыва на 1 единицу с каждым уровнем мастера. Добродушный -2% повреждений.",1,1,1,function(){},function(){},{}],PE_KEEN:["Зоркий"," Режется штраф дыма (60-дистанция)/2. В случае выстрела очередью игнор дыма.",1,6,29,function(){},function(){},{stats:{PER:5}}],PE_STEELRAIN:["Боевой аналитик","Вы способны быстро и точно проанализировать траекторию полёта ракет. При стрельбе из базук (включая шайтанки) радиус взрыва боеприпаса увеличивается на 2 гекса.",1,12,29,function(){},function(){},{stats:{PER:7},skills:{science:160}}],PE_MA_SKIT:["Житель Пустоши","Вы настолько изучили пустошь, что получаете +5% к навыку Скиталец и +1% к скорости по глобалу.",1,1,1,function(){},function(){},{}],PE_MA_REM:["Опытный ремонтник","Вы настолько часто ремонтировали, что получаете +3% к навыку Ремонт и +1% к навыку Наука с каждым уровнем этой способности.",1,1,1,function(){},function(){},{}],PE_MA_FIX:["Опытный инженер","Вы настолько часто изобретали, что получаете +3% к навыку Наука и +1% к навыку Ремонт с каждым уровнем этой способности.",1,1,1,function(){},function(){},{}],PE_MA_AID:["Опытный врач","Вы настолько часто лечили, что получаете +2% к навыку Санитар и +2% к навыку Доктор с каждым уровнем этой способности.",1,1,1,function(){},function(){},{}],PE_CLASS:["Класс персонажа","1-Разведчик, 2-Пулеметчик, 3-Берсерк, 4-Уворотчик, 5-Танк, 6-Медик, 7-Стрелок. 8-Пироман",1,1,1,function(){},function(){},{}],PE_SUPPORTER:["Огневая поддержка",'Стрельба очередями "Подавляет" врага. Увеличен радиус Дымовой и Газовой завесы, и область поджигания Кокт. "Молотова". Также вы получате +20% к навыку Метательное.',1,9,29,function(){pr.add("skills","thrown",20,1)},function(){pr.add("skills","thrown",-20,1)},{stats:{PER:7,AGI:7},skills:{thrown:100}}]};function testPerk(t){var s=perk[t][7],a=!1;if(!emptyObject(s)&&"stats"in s)for(var r in s.stats)if("ormode"in s&&"stats"in s.ormode)r in s.ormode.stats&&stats[r][2]>=s.stats[r]&&(a=a||!0);else{if(s.ch&&stats[r][2]>=s.stats[r])return!1;if(!s.ch&&stats[r][2]<s.stats[r])return!1}return!("ormode"in s&&!a)}function testpp(t){t=void 0===t?40:t;var s={n:0,sum:0,arr:[],max:0};for(var a in stats)stats[a][2]=1;for(;;){if(stats.STR[2]++,stats.STR[2]>10&&(stats.STR[2]=1,stats.PER[2]++),stats.PER[2]>10&&(stats.PER[2]=1,stats.ENU[2]++),stats.ENU[2]>10&&(stats.ENU[2]=1,stats.CHA[2]++),stats.CHA[2]>10&&(stats.CHA[2]=1,stats.INT[2]++),stats.INT[2]>10&&(stats.INT[2]=1,stats.AGI[2]++),stats.AGI[2]>10&&(stats.AGI[2]=1,stats.LUC[2]++),stats.LUC[2]>10)return s.arr.join(" ")+" "+s.max+"/122 перков доступно";for(var a in s.sum=0,stats)s.sum+=stats[a][2];if(s.sum==t){for(var a in s.n=0,perk)testPerk(a)&&1!==perk[a][4]&&s.n++;if(s.n>s.max)for(var a in s.max=s.n,s.arr=[],stats)s.arr.push(stats[a][2])}}}var quest={medals:["Медали","Делая различные квесты и убивая гуманоидов и животных можно получить немного медалей, которые можно потратить на различные бонусы.",200,2,99,function(){return!0},function(){talk(dialog.med+(quest.medals[2]-chobj("quest","medals"))+dialog.med2,{amedals:[dialog.medals.amedals,function(){return charp.points++,numbers($("#point1"),charp.points),[1,3]},quest.medals[2]-chobj("quest","medals")>=3],cmedals:[dialog.medals.cmedals,function(){return pr.add("feats","maxl",15),[2,5]},quest.medals[2]-chobj("quest","medals")>=5],bmedals:[dialog.medals.bmedals,function(){return pr.add("feats","live",1),[3,7]},quest.medals[2]-chobj("quest","medals")>=7],fmedals:[dialog.medals.fmedals,function(){return charp.points+=10,medsp+=10,numbers($("#point1"),charp.points),[4,10]},quest.medals[2]-chobj("quest","medals")>=10&&medsp<maxMedals()],gmedals:[dialog.medals.gmedals.split("%n%").join(maxMedals()),function(){return charp.points+=maxMedals(),medsp+=maxMedals(),numbers($("#point1"),charp.points),[5,maxMedals()]},quest.medals[2]-chobj("quest","medals")>=maxMedals()&&0==medsp],zmedals:[dialog.none,function(){return 0},!0]})}],PE_NCR_REPAIR:["Секреты мастерства: Ремонт","Механик Модока ознакомил вас с новой технологией починки оружия. Ваш навык Ремонта повышен на 5%.",1,2,99,function(){return!0},function(){pr.add("skills","repair",5,1)}],ranger_smile:["Скиталец у Смайли","Смайли по доброте душевно соврешенно бесплатно может прокачать скитальца до 60-69%",1,2,99,function(){return skills.ranger[0]<60},function(){for(var t=10;skills.ranger[0]+t<60;)t+=10;pr.add("skills","ranger",t,1)}],ranger_slim:["+2% скиталец","За небольшую плату в 100 монеток Слим из Кламата разкажет много интересного об охоте на гекко.",1,2,99,function(){return!0},function(){pr.add("skills","ranger",2,1)}],melee_klam:["Рукопашка +30%","В охотничих угодьях Кламата бывший боксер может обучить приемам рукопашного боя за небольшую услугу.",1,2,99,function(){return!0},function(){pr.add("skills","melee",30,1)}],hp_den:["+hp в Дене","Священник в церквушке Дена может укрепить ваше здоровье, если вы спросите его про дела церкви.",1,2,99,function(){return!0},function(){pr.add("feats","live",stats.CHA[2])}],light_den:["Легкое оружие в Яме","При наличии нбольшой суммы в размере 3к монеток можно поднять легкое оружие в зависимости от Вашей харизмы",1,2,99,function(){return skills.light[0]>=80&&skills.light[0]<120},function(){pr.add("skills","light",2*stats.CHA[2],1)}],overviewq:["+1 обзора в Яме","При хорошей репутации в Дене и выполнении парочки несложных заданий отца Клиффа, можно получить от него чудодейственное благословление.",1,2,99,function(){return!0},function(){pr.add("feats","oview",1)}],quest_arroyo:["Квесты в Арройо","В процесе набора репутации в Арройо можно получить +1% торговли, +5% ловушки и +1% скитальца, а при наборе 20 репутации Катрин будет рада обучить взлому, так если бы вы прочитали 3 книги по взлому.",1,2,99,function(){return!0},function(){pr.add("skills","trade",1,1),pr.add("skills","traps",5,1),pr.add("skills","ranger",1,1);var t=skpoint(skills.hack[0],18);pr.add("skills","hack",t[0],1)}],per_ncr:["+4% анти/крит в НКР","При хорошей репутации в НКР местный доктор согласится сделать операцию всего за каких-то 50к монеток.",1,30,99,function(){return charp.level>=30},function(){talk(dialog.per_ncr,{crit5:[questinfo.per_ncr[0],function(){return pr.add("feats","crit",4),1},!0],anticrit5:[questinfo.per_ncr[1],function(){return pr.add("feats","acrit",4),2},!0],none:[dialog.none,function(){return 0},!0]})}],cha_vc:["+1 Обояние в ГУ","Если найти голодиск с инструкциями по пластической хирургии для докторши в ГУ, то она с радостью сделает вам операцию.",1,2,99,function(){return stats.CHA[2]<3&&skills.oratory[0]>79},function(){mychar.stats.CHA[1]++},function(){mychar.stats.CHA[1]--}],ac_12:["+12 AC (Класс брони)","Джеймс из Нью-Рено попросит выполнить вас несколько заданий, за это он обучит вас лучше уклоняться, +12 класс брони.",1,2,99,function(){return!0},function(){pr.add("feats","armc",12)}],ap_vc:["+1 ОД (ГУ)","За прохождение цепочки квестов на гвардейца в ГУ можно пройти дополнительную боевую подготовку.",1,2,99,function(){return!0},function(){pr.add("feats","apoi",1)}],ap_hack:["+1 ОД (взлом)","За уничтожение лагеря рейдеров Риана научит вас двигаться быстрее.",1,2,99,function(){return skills.hack[0]>199},function(){pr.add("feats","apoi",1)}],heavy_bh:["+5% тяжа и рукопашной в БХ","За небольшую пикантную услугу Маркус обучит вас владению тяжелым оружием и правильно бить в дыню.",1,2,99,function(){return skills.ranger[0]>99},function(){pr.add("skills","heavy",5,1),pr.add("skills","melee",5,1)}],skill_geck:["+3% боевые в Гекко","За небольшое пожертвование местный мэр обучит вас боевым навыкам.",1,2,99,function(){return!0},function(){pr.add("skills","light",3,1),pr.add("skills","heavy",3,1),pr.add("skills","energy",3,1),pr.add("skills","melee",3,1),pr.add("skills","steel",3,1)}],trade_den:["+5% торговли","Выполнив все задания Джеймса в Яме можно обучиться у него торговле.",1,2,99,function(){return!0},function(){pr.add("skills","trade",5,1)}],trade_mod:["+7% торговли","Став почетным гражданином Модока можно обучится торговли у местного мера.",1,2,99,function(){return!0},function(){pr.add("skills","trade",7,1)}],trade_up:["Торговля до 240%","C каждой сделкой навык торговли повышается и вот вы уже набрали 240%.",1,2,99,function(){return!0},function(){pr.add("skills","trade",240-skills.trade[0],1)}],steel_reno:["Холодное оружие +10%","В Нью-Рено у младшего Мордино можно научится приемам с ножом всего за 200 монет.",1,2,99,function(){return!0},function(){pr.add("skills","steel",10,1)}],valerie_letter:["Письмо Валери","Легкое оружие +10% и Ремонт +10%",1,2,99,function(){return!0},function(){pr.add("skills","repair",10,1),pr.add("skills","light",10,1)}],drayfild:["НеоАрк","Кароче праходим значит убиваим асу и жука получаем ништяки на выбор. (все равно это никто не читает)",1,21,99,function(){return!0},function(){talk(dialog.drayfild,{adrayfild:["["+questinfo.drayfild[0]+"]",function(){return pr.add("skills","melee",5,1),pr.add("skills","steel",5,1),pr.add("skills","light",5,1),pr.add("skills","energy",5,1),pr.add("skills","heavy",5,1),1},!0],bdrayfild:["["+questinfo.drayfild[1]+"]",function(){return pr.add("skills","melee",10,1),2},!0],cdrayfild:["["+questinfo.drayfild[2]+"]",function(){return pr.add("skills","steel",10,1),3},!0],ddrayfild:["["+questinfo.drayfild[3]+"]",function(){return pr.add("skills","light",10,1),4},!0],edrayfild:["["+questinfo.drayfild[4]+"]",function(){return pr.add("skills","heavy",10,1),5},!0],idrayfild:["["+questinfo.drayfild[5]+"]",function(){return pr.add("skills","energy",10,1),6},!0],gdrayfild:["["+questinfo.drayfild[6]+"]",function(){return pr.add("skills","orderly",5,1),pr.add("skills","doctor",5,1),7},!0],fdrayfild:["["+questinfo.drayfild[7]+"]",function(){return pr.add("skills","thrown",10,1),8},!0],hdrayfild:[dialog.drynone,function(){return 0},!0]})}],imp_battle:["Боевой имплант","В вас вживлен один из эксперементальных имплантантов. Ваши боевые навыки увеличены.",1,2,99,function(){return!0},function(){talk(dialog.imp_battle,{aimp_battle:[questinfo.imp_battle[0].replace("%n%",skpoint(skills.light[0],120)[0]),function(){return addPoint=skpoint(skills.light[0],120)[0],pr.add("skills","light",addPoint,1),[2,[["light",addPoint]]]},!0],bimp_battle:[questinfo.imp_battle[1].replace("%n%",skpoint(skills.heavy[0],120)[0]),function(){return addPoint=skpoint(skills.heavy[0],120)[0],pr.add("skills","heavy",addPoint,1),[2,[["heavy",addPoint]]]},!0],cimp_battle:[questinfo.imp_battle[2].replace("%n%",skpoint(skills.energy[0],120)[0]),function(){return addPoint=skpoint(skills.energy[0],120)[0],pr.add("skills","energy",addPoint,1),[3,[["energy",addPoint]]]},!0],dimp_battle:[questinfo.imp_battle[3].replace("%n%",skpoint(skills.thrown[0],120)[0]),function(){return addPoint=skpoint(skills.thrown[0],120)[0],pr.add("skills","thrown",addPoint,1),[4,[["thrown",addPoint]]]},!0],eimp_battle:[questinfo.imp_battle[4].replace("%n%",skpoint(skills.repair[0],100)[0]),function(){return addPoint=skpoint(skills.repair[0],100)[0],pr.add("skills","repair",addPoint,1),[5,[["repair",addPoint]]]},!0],fimp_battle:[questinfo.imp_battle[5].replace("%n%",skpoint(skills.melee[0],100)[0]).replace("%r%",skpoint(skills.steel[0],100)[0]),function(){return addPointMelee=skpoint(skills.melee[0],100)[0],pr.add("skills","melee",addPointMelee,1),addPointSteel=skpoint(skills.steel[0],100)[0],pr.add("skills","steel",addPointSteel,1),[6,[["melee",addPointMelee],["steel",addPointSteel]]]},!0],none:[dialog.none,function(){return 0},!0]})}],imp_medical:["Медицинский имплант","В вас вживлен один из эксперементальных имплантантов. Ваши познания в медицине увеличены.",1,2,99,function(){return!0},function(){talk(dialog.imp_medical,{aimp_medical:[questinfo.imp_medical[0].replace("%n%",skpoint(skills.orderly[0],120)[0]),function(){return addPoint=skpoint(skills.orderly[0],120)[0],pr.add("skills","orderly",addPoint,1),[1,[["orderly",addPoint]]]},!0],bimp_medical:[questinfo.imp_medical[1],function(){return pr.add("feats","dodge",3),pr.add("feats","armc",5),2},!0],cimp_medical:[questinfo.imp_medical[2].replace("%n%",skpoint(skills.doctor[0],80)[0]),function(){return addPoint=skpoint(skills.doctor[0],80)[0],pr.add("skills","doctor",addPoint,1),pr.add("feats","live",10),pr.add("feats","levh",5),[3,[["doctor",addPoint]]]},!0],dimp_medical:[questinfo.imp_medical[3].replace("%n%",skpoint(skills.doctor[0],80)[0]),function(){return addPoint=skpoint(skills.doctor[0],80)[0],pr.add("skills","doctor",addPoint,1),[3,[["doctor",addPoint]]]},!0],eimp_medical:[questinfo.imp_medical[4].replace("%n%",skpoint(skills.orderly[0],80)[0]),function(){return addPoint=skpoint(skills.orderly[0],80)[0],pr.add("skills","orderly",addPoint,1),[5,[["orderly",addPoint]]]},!0],fimp_medical:[questinfo.imp_medical[5].replace("%n%",skpoint(skills.doctor[0],80)[0]),function(){return pr.add("feats","live",15),addPoint=skpoint(skills.doctor[0],80)[0],pr.add("skills","doctor",addPoint,1),[6,[["doctor",addPoint]]]},!0],none:[dialog.none,function(){return 0},!0]})}],imp_auxiliary:["Вспомогательный имплант","В вас вживлен один из эксперементальных имплантантов. Ваши вспомогательные функции увеличены.",1,2,99,function(){return!0},function(){talk(dialog.imp_auxiliary,{aimp_auxiliary:[questinfo.imp_auxiliary[0],function(){return pr.add("feats","maxl",100),1},!0],bimp_auxiliary:[questinfo.imp_auxiliary[1],function(){return 2},!0],cimp_auxiliary:[questinfo.imp_auxiliary[2].replace("%n%",skpoint(skills.traps[0],60)[0]).replace("%r%",skpoint(skills.sneak[0],50)[0]),function(){return addPointTraps=skpoint(skills.traps[0],60)[0],pr.add("skills","traps",addPointTraps,1),addPointSneak=skpoint(skills.sneak[0],50)[0],pr.add("skills","sneak",addPointSneak,1),[3,[["traps",addPointTraps],["sneak",addPointSneak]]]},!0],dimp_auxiliary:[questinfo.imp_auxiliary[3].replace("%n%",skpoint(skills.oratory[0],60)[0]),function(){return addPoint=skpoint(skills.oratory[0],60)[0],pr.add("skills","oratory",addPoint,1),[4,[["oratory",addPoint]]]},!0],eimp_auxiliary:[questinfo.imp_auxiliary[4].replace("%n%",skpoint(skills.steal[0],60)[0]),function(){return addPointSteal=skpoint(skills.steal[0],60)[0],pr.add("skills","steal",addPointSteal,1),addPointHack=skpoint(skills.hack[0],60)[0],pr.add("skills","hack",addPointHack,1),[5,[["steal",addPointSteal],["hack",addPointHack]]]},!0],fimp_auxiliary:[questinfo.imp_auxiliary[5].replace("%n%",skpoint(skills.speed[0],60)[0]),function(){return addPoint=skpoint(skills.speed[0],60)[0],pr.add("skills","speed",addPoint,1),[6,[["speed",addPoint]]]},!0],none:[dialog.none,function(){return 0},!0]})}],PE_MA_SKIT:["Житель Пустоши(5)","Вы настолько изучили пустошь, что получаете +5% к навыку Скиталец и +1% к скорости по глобалу.",1,2,99,function(){return!0},function(){pr.add("skills","ranger",25,1)}],PE_MA_REM:["Опытный ремонтник(5)","Вы настолько часто ремонтировали, что получаете +3% к навыку Ремонт и +1% к навыку Наука с каждым уровнем этой способности.",1,2,99,function(){return!0},function(){pr.add("skills","repair",15,1),pr.add("skills","science",5,1)}],PE_MA_FIX:["Опытный инженер(5)","Вы настолько часто изобретали, что получаете +3% к навыку Наука и +1% к навыку Ремонт с каждым уровнем этой способности.",1,2,99,function(){return!0},function(){pr.add("skills","science",15,1),pr.add("skills","repair",5,1)}],PE_MA_AID:["Опытный врач(5)","Вы настолько часто лечили, что получаете +2% к навыку Санитар и +2% к навыку Доктор с каждым уровнем этой способности.",1,2,99,function(){return!0},function(){pr.add("skills","orderly",10,1),pr.add("skills","doctor",10,1)}]};function skillsmedals(t,s){var a={};for(var r in textskills)a[r]=[],a[r].push("+"+t+"% "+textskills[r][0]),a[r].push((function(){return[t,s]})),a[r].push(skills[r][0]<200);a.zmedals=[dialog.none,function(){return 0},!0],talk("Выберете навык",a)}var traits={TRAIT_FAST_METABOLISM:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","levh",15),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","levh",-15),delete mychar.traits[t],charp.tagt++)},TRAIT_BRUISER:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.stats.STR[0]+=3,pr.add("feats","apoi",-1),pr.add("feats","mdmg",25),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(mychar.stats.STR[0]-=3,pr.add("feats","apoi",1),pr.add("feats","mdmg",-25),delete mychar.traits[t],charp.tagt++)},TRAIT_SMALL_FRAME:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.stats.AGI[0]+=1,mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(mychar.stats.AGI[0]-=1,delete mychar.traits[t],charp.tagt++)},TRAIT_ONE_HANDER:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(delete mychar.traits[t],charp.tagt++)},TRAIT_FINESSE:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","crit",10),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","crit",-10),delete mychar.traits[t],charp.tagt++)},TRAIT_KAMIKAZE:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.stats.AGI[1]+=1,mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(mychar.stats.AGI[1]-=1,delete mychar.traits[t],charp.tagt++)},TRAIT_HEAVY_HANDED:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","levh",25),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","levh",-25),delete mychar.traits[t],charp.tagt++)},TRAIT_FAST_SHOT:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(delete mychar.traits[t],charp.tagt++)},TRAIT_BLOODY_MESS:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("skills","speed",125,1),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("skills","speed",-125,1),delete mychar.traits[t],charp.tagt++)},TRAIT_JINXED:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(delete mychar.traits[t],charp.tagt++)},TRAIT_GOOD_NATURED:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("skills","orderly",25,1),pr.add("skills","doctor",25,1),pr.add("skills","oratory",25,1),pr.add("skills","trade",25,1),pr.add("skills","light",-15,1),pr.add("skills","heavy",-15,1),pr.add("skills","energy",-15,1),pr.add("skills","steel",-15,1),pr.add("skills","melee",-15,1),pr.add("skills","thrown",-15,1),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("skills","orderly",-25,1),pr.add("skills","doctor",-25,1),pr.add("skills","oratory",-25,1),pr.add("skills","trade",-25,1),pr.add("skills","light",15,1),pr.add("skills","heavy",15,1),pr.add("skills","energy",15,1),pr.add("skills","steel",15,1),pr.add("skills","melee",15,1),pr.add("skills","thrown",15,1),delete mychar.traits[t],charp.tagt++)},TRAIT_CHEM_RELIANT:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","live",30),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","live",-30),delete mychar.traits[t],charp.tagt++)},TRAIT_CHEM_RESISTANT:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.traits[t]=1,mychar.stats.PER[0]+=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(delete mychar.traits[t],mychar.stats.PER[0]-=1,charp.tagt++)},TRAIT_SEX_APPEAL:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","maxl",50),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","maxl",-50),delete mychar.traits[t],charp.tagt++)},TRAIT_SKILLED:function(t){!mychar.traits[t]&&charp.tagt>0?(mychar.stats.CHA[0]+=2,mychar.stats.ENU[0]+=2,mychar.stats.INT[0]+=2,mychar.stats.AGI[0]+=2,mychar.traits[t]=1,charp.tags++,numbers($("#point2"),charp.tags),charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(mychar.stats.CHA[0]-=2,mychar.stats.ENU[0]-=2,mychar.stats.INT[0]-=2,mychar.stats.AGI[0]-=2,delete mychar.traits[t],charp.tags--,numbers($("#point2"),charp.tags),charp.tagt++)},TRAIT_NIGHT_PERSON:function(t){!mychar.traits[t]&&charp.tagt>0?(pr.add("feats","apoi",2),mychar.traits[t]=1,charp.tagt--):mychar.traits[t]&&charp.tagt<2&&(pr.add("feats","apoi",-2),delete mychar.traits[t],charp.tagt++)}},leveluping=!1,regi=!0,medsp=0,save=!1,mode=0,send=!1,req=!1,textSeachPerk="";function getRandInt(t,s){return Math.floor(Math.random()*(s-t+1))+t}var select={crperk:"",perk:"",quest:""},mychar={tperk:{},traits:{},perks:{},tags:{},skills:{},feats:{},resist:{},quest:{},points:{},stats:{STR:[8,0],PER:[7,0],ENU:[6,0],CHA:[1,0],INT:[8,0],AGI:[8,0],LUC:[2,0]},book:{light:[10,0,{}],energy:[10,0,{}],orderly:[10,0,{}],science:[10,0,{}],repair:[10,0,{}],ranger:[10,0,{}],prewar:[10,0,{}]}},charp={age:getRandInt(14,60),sex:"man",level:1,tagt:2,tags:3,points:0,specialpoint:0,perkpoint:0,name:""},SkillMod={MaxValue:300,Add2:100,Add3:125,Add4:150,Add5:175,Add6:200};startskills={light:function(){return 5+4*mychar.stats.AGI[0]},heavy:function(){return 2*mychar.stats.AGI[0]},energy:function(){return 0+2*mychar.stats.AGI[0]},melee:function(){return 30+2*(mychar.stats.STR[0]+mychar.stats.AGI[0])},steel:function(){return 20+2*(mychar.stats.STR[0]+mychar.stats.AGI[0])},thrown:function(){return 4*mychar.stats.AGI[0]},orderly:function(){return 2*(mychar.stats.PER[0]+mychar.stats.INT[0])},doctor:function(){return 5+mychar.stats.PER[0]+mychar.stats.INT[0]},sneak:function(){return 5+3*mychar.stats.AGI[0]},hack:function(){return 10+mychar.stats.AGI[0]+mychar.stats.PER[0]},steal:function(){return 3*mychar.stats.AGI[0]},traps:function(){return 10+mychar.stats.AGI[0]+mychar.stats.PER[0]},science:function(){return 4*mychar.stats.INT[0]},repair:function(){return 3*mychar.stats.INT[0]},oratory:function(){return 5*mychar.stats.CHA[0]},trade:function(){return 4*mychar.stats.CHA[0]},speed:function(){return 0},ranger:function(){return 2*(mychar.stats.ENU[0]+mychar.stats.INT[0])}};var pr={cr:function(t,s){charp.level in mychar[t]||(mychar[t][charp.level]={}),s in mychar[t][charp.level]||(mychar[t][charp.level][s]=[0,0])},del:function(t,s){this.ch(t,s)&&(0==mychar[t][charp.level][s][0]&&0==mychar[t][charp.level][s][1]&&delete mychar[t][charp.level][s],emptyObject(mychar[t][charp.level])&&delete mychar[t][charp.level])},add:function(t,s,a,r){r=void 0===r?0:r,this.cr(t,s),mychar[t][charp.level][s][r]+=a,this.del(t,s)},addn:function(t,s,a,r){a*=6;var e=skpoint(skills[s][0],a)[0];this.add(t,s,e,1)},addr:function(t,s,a){this.cr("resist",t),mychar.resist[charp.level][t][0]+=s,mychar.resist[charp.level][t][1]+=a,this.del("resist",t)},ch:function(t,s){if(charp.level in mychar[t]&&s in mychar[t][charp.level])return mychar[t][charp.level][s][0]>0},sum:function(t,s){var a=0;for(var r in mychar[t])s in mychar[t][r]&&(a+=mychar[t][r][s][0],a+=mychar[t][r][s][1]);return a},sumr:function(t){var s=[0,0];for(var a in mychar.resist)t in mychar.resist[a]&&(s[0]+=mychar.resist[a][t][0],s[1]+=mychar.resist[a][t][1]);return s}};function trait(){var t=this.id.substr(3);traits[t](t),statpoints(),settle(),mychar.traits[t]?$("#"+t).css("color","#ABABAB"):$("#"+t).css("color","#00FF00"),infoparm("traits",t)}function tags(){var t=this.id.substr(3);!(t in mychar.tags)&&charp.tags>0?(mychar.tags[t]=1,charp.tags--,pr.add("skills",t,20,1),$("#"+t+"s").css("color","#ABABAB"),$("#"+t).css("color","#ABABAB")):t in mychar.tags&&charp.tags<3&&(delete mychar.tags[t],charp.tags++,pr.add("skills",t,-20,1),$("#"+t+"s").css("color","#00FF00"),$("#"+t).css("color","#00FF00")),numbers($("#point2"),charp.tags),settle()}function settle(t){for(var s in t=t||!1,skills.light[0]=3*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.heavy[0]=2*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.energy[0]=0+2*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.melee[0]=30+2*(mychar.stats.STR[0]+mychar.stats.AGI[0])+mychar.stats.LUC[0],skills.steel[0]=20+2*(mychar.stats.STR[0]+mychar.stats.AGI[0])+mychar.stats.LUC[0],skills.thrown[0]=4*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.orderly[0]=2*(mychar.stats.PER[0]+mychar.stats.INT[0])+mychar.stats.LUC[0],skills.doctor[0]=5+mychar.stats.PER[0]+mychar.stats.INT[0]+mychar.stats.LUC[0],skills.sneak[0]=5+3*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.hack[0]=5+mychar.stats.AGI[0]+mychar.stats.PER[0]+2*mychar.stats.LUC[0],skills.steal[0]=3*mychar.stats.AGI[0]+mychar.stats.LUC[0],skills.traps[0]=9+mychar.stats.AGI[0]+mychar.stats.PER[0]+mychar.stats.LUC[0],skills.science[0]=3*mychar.stats.INT[0]+mychar.stats.LUC[0],skills.repair[0]=5+2*mychar.stats.INT[0]+mychar.stats.LUC[0],skills.oratory[0]=5*mychar.stats.CHA[0]+mychar.stats.LUC[0],skills.trade[0]=4*mychar.stats.CHA[0]+mychar.stats.LUC[0],skills.speed[0]=mychar.stats.LUC[0]-1,skills.ranger[0]=2*(mychar.stats.ENU[0]+mychar.stats.INT[0])+mychar.stats.LUC[0],skills)skills[s][0]+=pr.sum("skills",s);for(var s in mychar.stats)stats[s][2]=mychar.stats[s][0]+mychar.stats[s][1];for(var s in feat.live[0]=mychar.traits.TRAIT_GOOD_NATURED?80+mychar.stats.CHA[0]*mychar.stats.CHA[0]*2+5*mychar.stats.ENU[0]:200+5*mychar.stats.STR[0]+15*mychar.stats.ENU[0],feat.armc[0]=stats.AGI[2]*(mychar.traits.TRAIT_KAMIKAZE?0:1)+(mychar.traits.TRAIT_KAMIKAZE?1:0),feat.apoi[0]=7+Math.floor(stats.AGI[2]/3),feat.maxl[0]=Math.round(.453*(25+stats.STR[2]*(25-10*(mychar.traits.TRAIT_SMALL_FRAME?1:0)))),feat.mdmg[0]=stats.STR[2]>5?stats.STR[2]-5:1,feat.oview[0]=20+3*stats.PER[2],feat.stox[0]=(mychar.traits.TRAIT_FAST_METABOLISM?.5:1)*stats.ENU[2]*5,feat.stox[0]>95&&(feat.stox[0]=95),feat.srad[0]=(mychar.traits.TRAIT_FAST_METABOLISM?.5:1)*stats.ENU[2]*2,feat.srad[0]>95&&(feat.srad[0]=95),feat.proc[0]=2*stats.PER[2],feat.levh[0]=Math.floor(1.5*stats.CHA[2]),feat.crit[0]=2*(stats.LUC[2]-1)+stats.LUC[2]/2+(mychar.traits.TRAIT_SKILLED?5:0),feat.dodge[0]=checkperk("PE_HTH_EVADE")?feat.apoi[0]/4+feat.apoi[0]/2:0,mychar.traits.TRAIT_GOOD_NATURED&&(feat.dodge[0]=Math.floor(feat.dodge[0]/2)),feat.acrit[0]=checkperk("PE_TERMINATOR")?5*(stats.STR[2]+stats.ENU[2]):2*stats.STR[2]+(mychar.traits.TRAIT_SKILLED?25:0),feat)"dodge"==s&&mychar.traits.TRAIT_GOOD_NATURED?feat[s][0]+=Math.floor(pr.sum("feats",s)/2):feat[s][0]+=pr.sum("feats",s);for(var a in feat.crit[0]=mychar.traits.TRAIT_CHEM_RESISTANT?0:feat.crit[0],feat.acrit[0]>100&&(feat.acrit[0]=100),resist){var r=pr.sumr(a);$("#"+a).html(r[0]+" / "+r[1]+"%")}for(var e in skills)skills[e][0]>300&&(skills[e][0]=300),$("#"+e).html(skills[e][0]+"%");for(var e in feat)"acrit"!=e&&"crit"!=e&&"live"!=e&&"dodge"!=e?$("#"+e).html(feat[e][0]):"live"!=e?$("#"+e).html(feat[e][0]+"%"):$("#"+e).html(feat[e][0]+"/"+feat[e][0]);t&&"speed"==t&&(infoparm("skills","speed"),$("#buttreq").css("background-color","rgba(0, 255, 0, 0.55)"),$("#textparm").hide(),$("#textparmreq").show(),req=!0)}function statpoints(){for(var t in mychar.stats){var s=$("#"+t),a=mychar.stats[t],r="";r=(a=mychar.stats[t][0]+mychar.stats[t][1])<1||a>10?a<1?statlvl[1]:a>10?statlvl[10]:"Error":statlvl[a],$("#"+t+"t").html(r),numbers(s,a)}numbers($("#specialpoint"),charp.specialpoint),settle(),createlistperk()}function numbers(t,s){t.hasClass("numspec")&&(s<1||s>10)?(s<1&&(s=0),t.css("text-shadow","0 0 1px #e00")):t.css("text-shadow","0 0 1px #dedede"),t.html(""),t.css("background-image","url(img/nums.png )");var a=1,r=[0,0,0];s>99&&(t.css("background-image","url(img/num3.png )"),r[2]=Math.floor(s/100),a++),r[1]=Math.floor(s/10)-10*r[2],r[0]=Math.floor(s/1)-10*r[1]-100*r[2],t.css({"padding-left":"5px","letter-spacing":"4px"}),(0===r[2]&&1==r[1]||1==r[2])&&t.css({"padding-left":"6px","letter-spacing":"6px"}),1==r[1]&&1==r[2]&&(t.css({"letter-spacing":"8px"}),1==r[0]&&t.css({"letter-spacing":"9px"})),r[2]>1&&1==r[0]&&t.css({"letter-spacing":"6px"}),(r[2]>1&&1==r[1]||1==r[0]&&1==r[2]||1==r[0]&&1==r[1])&&t.css({"letter-spacing":"7px"});for(var e=a;e>=0;e--)t.append(r[e])}function plusspec(t){var s=this.id.substr(4),a=mychar.stats[s][0]+mychar.stats[s][1],r=charp.specialpoint;a<10&&0!==r&&(a++,r--),mychar.stats[s][0]=a-mychar.stats[s][1],charp.specialpoint=r,statpoints()}function minusspec(t){var s=this.id.substr(5),a=mychar.stats[s][0]+mychar.stats[s][1];if(!(mychar.traits.TRAIT_SKILLED&&a<4&&"STR"!=s&&"PER"!=s&&"LUC"!=s)){var r=charp.specialpoint;a>1&&(a--,r++),mychar.stats[s][0]=a-mychar.stats[s][1],charp.specialpoint=r,statpoints()}}function skpoint(t,s){for(var a=[0,0],r=s;r>0&&s>0;r--){if(t>SkillMod.Add6){if(!(s>=6))break;s-=6}else if(t>SkillMod.Add5){if(!(s>=5))break;s-=5}else if(t>SkillMod.Add4){if(!(s>=4))break;s-=4}else if(t>SkillMod.Add3){if(!(s>=3))break;s-=3}else if(t>SkillMod.Add2){if(!(s>=2))break;s-=2}else{if(!(t<=SkillMod.Add2))break;if(!(s>=1))break;s-=1}a[0]++,t++}return a[1]=s,a}function plus(){var t=this.id.substr(4),s=skills[t][0];if(!(s>=SkillMod.MaxValue)){var a=1;s>SkillMod.Add6?a=6:s>SkillMod.Add5?a=5:s>SkillMod.Add4?a=4:s>SkillMod.Add3?a=3:s>SkillMod.Add2&&(a=2),charp.points<a||(s++,t in mychar.tags&&s<SkillMod.MaxValue&&s++,pr.add("skills",t,s-skills[t][0]),charp.points-=a,numbers($("#point1"),charp.points),settle(t))}}function minus(){var t=this.id.substr(5),s=skills[t][0];if(!(s<=0)&&pr.ch("skills",t)){for(var a=(t in mychar.tags?2:1),r=0;r<a;r++){var e=1;s>SkillMod.Add6+1?e=6:s>SkillMod.Add5+1?e=5:s>SkillMod.Add4+1?e=4:s>SkillMod.Add3+1?e=3:s>SkillMod.Add2+1&&(e=2),s>0&&s--}pr.add("skills",t,s-skills[t][0]),charp.points+=e,numbers($("#point1"),charp.points),settle(t)}}function modalCloseEsc(t){t.keyCode&&27!==t.keyCode||($("#entername").hide(),$("#enterage").hide(),$("#entersex").hide(),$("#wrap").hide(),$("#perk").hide(),$("#quest").hide(),$("#total").hide())}function modalCloseClick(){$("#entername").hide(),$("#enterage").hide(),$("#entersex").hide(),$("#wrap").hide()}function showthis(){str=this.id,$("#enter"+str).show(),$("#wrap").show()}function plusage(){charp.age++,charp.age>60&&(charp.age=14),numbers($("#numberage"),charp.age),$("#age").html(charp.age)}function minusage(){charp.age--,charp.age<14&&(charp.age=60),numbers($("#numberage"),charp.age),$("#age").html(charp.age)}function changesex(){"men"===this.id&&"men"!==charp.sex?(charp.sex="men",$("#men").css("backgroundImage","url(img/men.png)"),$("#women").css("backgroundImage",""),$("#sex").html(sextext.men)):"women"===this.id&&"women"!==charp.sex&&(charp.sex="women",$("#women").css("backgroundImage","url(img/women.png)"),$("#men").css("backgroundImage",""),$("#sex").html(sextext.women))}function leveling(){if(!charp.specialpoint&&!charp.tags||leveluping)if(regi){charp.name||("man"==charp.sex&&(charp.name=nameman[getRandInt(0,nameman.length-1)]),"women"==charp.sex&&(charp.name=namewoman[getRandInt(0,namewoman.length-1)])),$("#namenter").html(charp.name),$("#name").html($("#namenter").html().toUpperCase()),$("title").text(anytext.training),$("#main").stop(!0,!0),$("#main").animate({opacity:"0"},100);var t=new Image;if(t.src="img/char.gif",t.onload=function(){$("#main").css("backgroundImage","url("+t.src+")"),$("#main").animate({opacity:"1"},500)},$(".reg").hide(),$(".leveling").show(),$("#level").html(charp.level),$("#exp").html(levelexp(charp.level)),$("#nextexp").html(levelexp(charp.level+1)),numbers($("#point1"),charp.points),!$("div").is("#select")){$("<div/>",{id:"select"}).appendTo("#main").css({backgroundImage:"url(img/skillpad.png)",position:"absolute",top:"-9px",left:"324px",width:"286px",height:"70px","z-index":"100"});var s,a=$("<div/>",{id:"pluslight"}).appendTo("#select").css({position:"absolute",left:"246px",width:"33px",height:"33px"}),r=$("<div/>",{id:"minuslight"}).appendTo("#select").css({position:"absolute",left:"246px",top:"33px",width:"33px",height:"33px"});a.mousedown((function(){a.css("backgroundImage","url(img/greendot_big.png)")})),a.mouseup((function(){a.css("backgroundImage","")})),r.mousedown((function(){r.css("backgroundImage","url(img/greendot_big.png)")})),r.mouseup((function(){r.css("backgroundImage","")})),a.click(plus),r.click(minus);var e,i=1,n=1;a.on("mousedown",(function(){clearInterval(s),i=1,s=setInterval((function(){for(var t=0;t<i;t++)a.click();i<10&&(i+=2)}),200)})),a.on("mouseup mouseout",(function(){clearInterval(s)})),r.on("mousedown",(function(){clearInterval(e),n=1,e=setInterval((function(){for(var t=0;t<n;t++)r.click();n<10&&(n+=2)}),200)})),r.on("mouseup mouseout",(function(){clearInterval(e)}))}showlistperk(),regi=!1,$("#nameparm").html(""),$("#textparm").html(""),$("#imgparm").html("")}else charp.level>=28&&setbuild();else alert(anytext.msgerror)}function reg(){Cookies.remove("hash",{path:""}),document.location.search=""}function levelexp(t){for(var s=0,a=0;a<t;a++)s+=1e3*a;return s}function switchinfo(){for(var t=+this.id.substr(10),s=1;s<4;s++)t===s?($("#textlist1").is(":visible")&&charp.perkpoint?listperkup():3===t&&listquestup(),$("#textlist"+s).show(),$("#switch"+s).css("backgroundImage","url(img/switchon.png)"),$("#textswitch"+s).css("top","7px")):($("#switch"+s).css("backgroundImage","url(img/switchoff.png)"),$("#textswitch"+s).css("top","9px"),$("#textlist"+s).hide())}function selectskill(){if(!regi){var t=$("#select").remove(),s=this.offsetParent.offsetTop+this.offsetTop-27,a=this.offsetParent.offsetLeft+this.offsetLeft-6;t.appendTo("#main").css({top:s+"px",left:a+"px"});var r,e=t.find("div")[0].id="plus"+this.id.substr(4),i=t.find("div")[1].id="minus"+this.id.substr(4);$("#"+e).mousedown((function(){$("#"+e).css("backgroundImage","url(img/greendot_big.png)")})),$("#"+e).mouseup((function(){$("#"+e).css("backgroundImage","")})),$("#"+i).mousedown((function(){$("#"+i).css("backgroundImage","url(img/greendot_big.png)")})),$("#"+i).mouseup((function(){$("#"+i).css("backgroundImage","")})),$("#"+e).click(plus),$("#"+i).click(minus);var n,l=1;$("#"+e).on("mousedown touchstart",(function(){clearInterval(r),l=1,r=setInterval((function(){for(var t=0;t<l;t++)$("#"+e).click();l<10&&(l+=2)}),200)})),$("#"+e).on("mouseup mouseout touchend",(function(){clearInterval(r)}));var c=1;$("#"+i).on("mousedown touchstart",(function(){clearInterval(n),c=1,n=setInterval((function(){for(var t=0;t<c;t++)$("#"+i).click();c<10&&(c+=2)}),200)})),$("#"+i).on("mouseup mouseout touchend",(function(){clearInterval(n)}))}}function levelup(){$("#leveldown").show(),99!=charp.level?(mychar.points[charp.level]=charp.points,charp.level++,$("#level").html(charp.level),$("#exp").html(levelexp(charp.level)),$("#nextexp").html(levelexp(charp.level+1)),charp.level<29?(charp.points+=5+2*stats.INT[2]+(mychar.traits.TRAIT_SKILLED?3:0)-(mychar.traits.TRAIT_NIGHT_PERSON?3:0),numbers($("#point1"),charp.points)):charp.level>29&&!(charp.level%3)&&(pr.add("feats","live",1),feat.live[0]=pr.sum("feats","live")+16*stats.ENU[2]+3*stats.STR[2]+109,$("#live").html(feat.live[0]+"/"+feat.live[0])),charp.level%(mychar.traits.TRAIT_SKILLED&&!mychar.traits.TRAIT_GOOD_NATURED?4:mychar.traits.TRAIT_GOOD_NATURED&&!mychar.traits.TRAIT_SKILLED?2:3)||(charp.perkpoint=1,$("#textswitch1").addClass("perkup")),charp.perkpoint>0&&listperkup()):null==matrix&&(matrix=new Matrix)}function addperk(t){mychar.perks[t]={vol:checkperk(t)+1,lvl:checkperk(t)?mychar.perks[t].lvl:[]},mychar.perks[t].lvl.push(charp.level),perk[t][5]()}function delobj(t,s,a){if(chobj(t,s)<=1?delete mychar[t][s]:s in questinfo||"medals"==s?"medals"!=s&&delete mychar[t][s]:(mychar[t][s].vol--,delete mychar[t][s].lvl[a]),"medals"==s){var r=mychar[t][s].med[a][0],e=mychar[t][s].med[a][1];mychar[t][s].vol-=e,r>3&&(medsp-=e),delete mychar[t][s].med[a],delete mychar[t][s].lvl[a],chobj(t,s)||delete mychar[t][s]}"perks"==t&&void 0!==perk[s][6]&&perk[s][6]()}function checkperk(t){return void 0===mychar.perks[t]?0:mychar.perks[t].vol}function chobj(t,s){return void 0===mychar[t][s]?0:mychar[t][s].vol}function chtr(t){return void 0===mychar.traits[t]?0:mychar.traits[t]}function leveldown(){if(!(charp.level<2)){for(var t in mychar.perks)for(var s in mychar.perks[t].lvl)mychar.perks[t].lvl[s]==charp.level&&delobj("perks",t,s);for(var t in mychar.quest)for(var s in mychar.quest[t].lvl)mychar.quest[t].lvl[s]==charp.level&&delobj("quest",t,s);for(var t in mychar.book)for(var s in mychar.book[t][2])if(s==charp.level){if("prewar"!=t)mychar.book[t][0]+=mychar.book[t][2][s][t][0];else for(var a in mychar.book[t][2][s])mychar.book[t][0]+=mychar.book[t][2][s][a][0];delete mychar.book[t][2][s]}for(var t in delete mychar.feats[charp.level],delete mychar.skills[charp.level],delete mychar.resist[charp.level],charp.level%(mychar.traits.TRAIT_SKILLED&&!mychar.traits.TRAIT_GOOD_NATURED?4:mychar.traits.TRAIT_GOOD_NATURED&&!mychar.traits.TRAIT_SKILLED?2:3)||charp.perkpoint>0&&(charp.perkpoint=0,$("#textswitch1").removeClass("perkup")),charp.level--,charp.points=mychar.points[charp.level],mychar.book)$("#book"+t).html("x"+mychar.book[t][0]);$("#level").html(charp.level),$("#exp").html(levelexp(charp.level)),$("#nextexp").html(levelexp(charp.level+1)),1==charp.level&&$("#leveldown").hide(),numbers($("#point1"),charp.points),statpoints(),settle(),showlistquest(),showlistperk()}}function listperkup(){for(var t in $("#perk").show(),$("#perk").animate({opacity:"1"},200),$("#selectperk").html(""),$("#nameparms").html(""),$("#textparms").html(""),$("#imgparms").html(""),select.perk="",perk){if(verRequirPerk(t))$('<div id="'+t+'" class="perklist">'+textperk[t][0]+"</div>").appendTo("#selectperk").click((function(){select.perk&&$("#"+select.perk).css("color","#00AB00"),select.perk=this.id,$("#"+this.id).css("color","#00FF00"),infoperk(this.id)}))}}function createlistperk(){$("#crlistperk").html("");var t={2:[],6:[],9:[],12:[],15:[],18:[],30:[],32:[],51:[]},s=0;if("tperk"in mychar||(mychar.tperk={}),0==mode){for(var a in perk)if(1!==perk[a][4]){let s=33==perk[a][3]?32:perk[a][3];try{perk[a][0].toLowerCase().includes(textSeachPerk)&&t[s].push(a)}catch(t){console.log(t,perk,s,a,perk[a])}}}else if(1==mode){for(var a in mychar.tperk){t[33==perk[a][3]?32:perk[a][3]].push(a),s++}$('<div class="listlevel">'+anytext.perks+s+" / "+(mychar.traits.TRAIT_SKILLED?7:mychar.traits.TRAIT_GOOD_NATURED?14:9)+"</div><hr>").appendTo("#crlistperk")}for(var a in t)if(0!==t[a].length)for(var r in $('<div id="lists'+a+'" class="listlevel">'+anytext.lvl+a+"</div>").appendTo("#crlistperk"),t[a]){var e=$('<div id="lists'+t[a][r]+'" class="perklist">'+textperk[t[a][r]][0]+(perk[t[a][r]][2]>1?"("+perk[t[a][r]][2]+")":"")+"</div>").appendTo("#crlistperk");t[a][r]in mychar.tperk&&$("#lists"+t[a][r]).css("color","#07B"),verPerkandTrait(t[a][r])||$("#lists"+t[a][r]).css("color","#B00"),e.click((function(){select.crperk&&(verPerkandTrait(select.crperk.substr(5))?select.crperk.substr(5)in mychar.tperk?$("#"+select.crperk).css("color","#07B"):$("#"+select.crperk).css("color","#00AB00"):$("#"+select.crperk).css("color","#B00")),select.crperk=this.id,verPerkandTrait(select.crperk.substr(5))?$("#"+this.id).css("color","#0F0"):$("#"+this.id).css("color","#F00"),infoparm("perks",this.id.substr(5))})),e.dblclick((function(){var t=this.id.substr(5);verPerkandTrait(t)&&(t in mychar.tperk?(delete mychar.tperk[t],$("#"+this.id).css("color","#0F0")):(mychar.tperk[t]=1,$("#"+this.id).css("color","#07B")),decalc())}))}}function verPerkandTrait(t){var s=perk[t][7];if(!emptyObject(s)){if("traits"in s)for(var a in s.traits)if(a in mychar.traits){if(1==s.traits[a])return delete mychar.tperk[t],!1}else if(0==s.traits[a])return delete mychar.tperk[t],!1;if("perks"in s)for(var a in s.perks)if(a in mychar.tperk){if(1==s.perks[a])return delete mychar.tperk[t],!1}else if(0==s.perks[a])return!1}return!0}function verRequirPerk(t){if(checkperk(t)>=perk[t][2])return!1;if(charp.level<perk[t][3]||charp.level>perk[t][4])return!1;var s=perk[t][7],a=!1;if(!emptyObject(s)){if("traits"in s)for(var r in s.traits)if(r in mychar.traits){if(1==s.traits[r])return!1}else if(0==s.traits[r])return!1;if("perks"in s)for(var r in s.perks)if(r in mychar.perks){if(1==s.perks[r])return!1}else if(0==s.perks[r])return!1;if("skills"in s)for(var r in s.skills)if("ormode"in s&&"skills"in s.ormode)r in s.ormode.skills&&skills[r][0]>=s.skills[r]&&(a=a||!0);else if(skills[r][0]<s.skills[r])return!1;if("stats"in s)for(var r in s.stats)if("ormode"in s&&"stats"in s.ormode)r in s.ormode.stats&&stats[r][2]>=s.stats[r]&&(a=a||!0);else{if(s.ch&&stats[r][2]>=s.stats[r])return!1;if(!s.ch&&stats[r][2]<s.stats[r])return!1}}return!("ormode"in s&&!a)}function testperks(t){t=void 0===t?40:t;var s={};for(var a in skills)$("#s"+a).html(""),s[a]=0;for(var r in stats)stats[r][2]=1;for(var r in mychar.tperk){var e=perk[r][7];if(!emptyObject(e)){if("stats"in e)for(var a in e.stats)e.stats[a]>stats[a][2]&&!e.ch&&(stats[a][2]=e.stats[a]);if("skills"in e)for(var a in e.skills)s[a]<e.skills[a]&&(s[a]=e.skills[a]),$("#s"+a).html(s[a]+"%")}}var i=0,n={};for(var r in stats)i+=stats[r][2],n[r]=stats[r][2];return[i,n]}function decalc(){if(regi){if(emptyObject(mychar.tperk))testperks(),mychar.stats={STR:[8+(chtr("TRAIT_BRUISER")?2:0),0],PER:[7,0+(chtr("TRAIT_CHEM_RESISTANT")?1:0)],ENU:[8+(chtr("TRAIT_SKILLED")?2:0),0],CHA:[1+(chtr("TRAIT_SKILLED")?2:0),0],INT:[8+(chtr("TRAIT_SKILLED")?2:0),0],AGI:[7+(chtr("TRAIT_SMALL_FRAME")?1:0)+(chtr("TRAIT_SKILLED")?2:0),0+(chtr("TRAIT_KAMIKAZE")?1:0)],LUC:[1,0]},charp.specialpoint=0;else{var t=40+(chtr("TRAIT_BRUISER")?2:0)+(chtr("TRAIT_SMALL_FRAME")?1:0)+(chtr("TRAIT_KAMIKAZE")?1:0)+(chtr("TRAIT_SKILLED")?8:0)+(chtr("TRAIT_CHEM_RESISTANT")?1:0),s=testperks(t);if(70==s[0])return;for(var a in charp.specialpoint=t-s[0],mychar.stats)mychar.stats[a][0]=s[1][a];chtr("TRAIT_KAMIKAZE")&&mychar.stats.AGI[0]--}statpoints()}}function showlistperk(){var t=$("#textlist1").html("");if(charp.tagt<2)for(var s in t.append('<div class="listhead">'+anytext.dop+"</div>"),mychar.traits)mychar.traits[s]&&(t.append('<div id="list'+s+'" class="perklist">'+texttraits[s][0]+"</div>"),$("#list"+s).click((function(){infoparm("traits",this.id.substr(4))})));if(!emptyObject(mychar.perks)){var a=[];for(var s in t.append('<div class="listhead">'+anytext.bonus+"</div>"),mychar.perks)for(var r in mychar.perks[s].lvl)a[mychar.perks[s].lvl[r]]=s;for(var s in a)t.append('<div><span id="lists'+s+'" class="listlvl">'+s+anytext.lvl3+' </span><span id="list'+a[s]+'" class="perklist">'+textperk[a[s]][0]+"</span></div>"),$("#list"+a[s]).click((function(){infoparm("perks",this.id.substr(4))}))}}function listquestup(){var t=!1;for(var s in quest)t=t||chobj("quest",s)<quest[s][2]&&charp.level>=quest[s][3]&&charp.level<=quest[s][4]&&quest[s][5]();if(t)for(var s in $("#quest").show(),$("#selectquest").html(""),$("#nameparmq").html(""),$("#textparmq").html(""),select.quest="",quest){if(chobj("quest",s)<quest[s][2]&&charp.level>=quest[s][3]&&charp.level<=quest[s][4]&&quest[s][5]())$('<div id="'+s+'" class="perklist">'+textquest[s][0]+"</div>").appendTo("#selectquest").click((function(){select.quest&&$("#"+select.quest).css("color","#00AB00"),select.quest=this.id,$("#"+this.id).css("color","#00FF00"),$("#nameparmq").html(textquest[this.id][0]),$("#textparmq").html(textquest[this.id][1])}))}}function showlistquest(){var t=$("#textlist3").html("");if(!emptyObject(mychar.quest)){var s=[];for(var a in t.append('<div class="listhead">'+anytext.quest+"</div>"),mychar.quest)for(var r in mychar.quest[a].lvl)null==s[mychar.quest[a].lvl[r]]&&(s[mychar.quest[a].lvl[r]]=[]),"medals"==a&&mychar.quest[a].med?s[mychar.quest[a].lvl[r]].push([a,r].concat(mychar.quest[a].med[r])):s[mychar.quest[a].lvl[r]].push(a);for(var a in s)for(var e in t.append('<div><span id="lists'+a+'" class="listlvl">'+a+anytext.lvl2+" </span></div>"),s[a]){var i=s[a][e];"object"==typeof i?(namequest=i[0],idquest=i[1],t.append('<div><span id="list'+namequest+idquest+'" data-namequest="'+namequest+'" data-idquest="'+idquest+'" class="perklist">'+textquest[namequest][0]+(chobj("quest",namequest)>1?"("+i[3]+")":"")+"</span></div>"),$("#list"+namequest+idquest).click((function(){infoparm("quest",this.dataset.namequest,this.dataset.idquest)}))):(t.append('<div><span id="list'+i+'" class="perklist">'+textquest[i][0]+(chobj("quest",i)>1?"("+chobj("quest",i)+")":"")+"</span></div>"),$("#list"+i).click((function(){infoparm("quest",this.id.substr(4))})))}}}function require(t){var s=anytext.treb,a=perk[t][7];if(s+="<br>"+anytext.lvl+": "+perk[t][3]+" - "+perk[t][4],"stats"in a)for(var r in a.stats)s+="<br>"+stats[r][0]+": "+(a.ch?"<":"")+a.stats[r];if("skills"in a)for(var r in a.skills)s+="<br>"+skills[r][2]+": "+a.skills[r];if("traits"in a)for(var r in a.traits)1==a.traits[r]?s+="<br><span class='deperk'>-"+texttraits[r][0]+"</span>":0==a.traits[r]&&(s+="<br><span class='dedeperk'>+"+texttraits[r][0]+"</span>");if("perks"in a)for(var r in a.perks)1==a.perks[r]?s+="<br><span class='deperk'>-"+textperk[r][0]+"</span>":0==a.perks[r]&&(s+="<br><span class='dedeperk'>-"+textperk[r][0]+"</span>");return s}function infoparm(t,s,a){switch(t){case"traits":$("#nameparm").html(texttraits[s][0]),$("#textparm").html(texttraits[s][1]),$("#textparmreq").html(""),$("#imgparm").removeClass("loaded"),$("#imgparm").html('<img src="skill/'+s+'.jpg" onload="imgLoaded(this)">');break;case"perks":$("#nameparm").html(textperk[s][0]),$("#textparm").html(textperk[s][1]),$("#textparmreq").html(require(s)),$("#imgparm").removeClass("loaded"),$("#imgparm").html('<img src="skill/'+s.substr(3)+'.jpg" onload="imgLoaded(this)">');break;case"quest":const t=["%n%","%r%"];$("#nameparm").html(textquest[s][0]),$("#textparmreq").html("");var r="";if(a||"medals"==s)r=textquest[s][1]+(s in questinfo&&a?"<br>"+questinfo[s][mychar.quest[s].med[a][0]-1]:"");else if("imp"==s.slice(0,3)){let a=s in questinfo?"<br>"+questinfo[s][mychar.quest[s].vol-1]:"";if(s in questinfo&&mychar.quest[s]?.sk){let r=mychar.quest[s].sk;for(let s=0;s<r.length;s++)a=a.replace(t[s],r[s][1])}r=textquest[s][1]+a}else r=textquest[s][1]+(s in questinfo?"<br>"+questinfo[s][mychar.quest[s].vol-1]:"");$("#textparm").html(r);break;case"skills":$("#nameparm").html(skills[s][2]),$("#textparm").html(skills[s][3]),$("#textparmreq").html("speed"==s&&skills.speed[0]>=100?"<br>Ходьба: "+Math.floor(3e5/(3e3-2.5*skills.speed[0]))+"%<br>Бег: "+Math.floor(2e5/(2e3-skills.speed[0]))+"%":""),$("#imgparm").removeClass("loaded"),$("#imgparm").html('<img src="skill/'+s+'.jpg" onload="imgLoaded(this)">');break;case"stats":$("#nameparm").html(stats[s][0]),$("#textparm").html(stats[s][1]),$("#textparmreq").html(""),$("#imgparm").removeClass("loaded"),$("#imgparm").html('<img src="skill/'+s+'.jpg" onload="imgLoaded(this)">')}}function infoperk(t){$("#nameparms").html(textperk[t][0]),$("#textparms").html(textperk[t][1]),$("#imgparms").removeClass("loaded"),$("#imgparms").html('<img src="skill/'+t.substr(3)+'.jpg" onload="imgLoaded(this)">')}function plusbook(){var t,s=this.id.substr(4);if(t="prewar"===s?"oratory":s,mychar.book[s][0]){var a=6+mychar.book[s][1],r=skpoint(skills[t][0],a);mychar.book[s][1]=r[1],pr.add("skills",t,r[0],1),charp.level in mychar.book[s][2]||(mychar.book[s][2][charp.level]={}),t in mychar.book[s][2][charp.level]||(mychar.book[s][2][charp.level][t]=[0,0]),mychar.book[s][2][charp.level][t][0]++,mychar.book[s][2][charp.level][t][1]+=r[0],mychar.book[s][0]--,$("#book"+s).html("x"+mychar.book[s][0]),settle()}}function talk(t,s){for(var a in $("#talk").show(),$("#dialog").html(t),$("#answ").html(""),s)if(s[a][2]){var r=$('<div id="answ'+a+'">&#149; '+s[a][0]+"</div>").appendTo("#answ");r.hover((function(){$(this).toggleClass("hover")})),r.click({func:s[a][1],name:s[a][0]},(function(t){var s=t.data.func();-1!=s&&($("#talk").hide(),0!==s&&("object"==typeof s&&"medals"==select.quest?(mychar.quest[select.quest]={vol:chobj("quest",select.quest)+s[1],lvl:chobj("quest",select.quest)?mychar.quest[select.quest].lvl:[],med:chobj("quest",select.quest)?mychar.quest[select.quest].med:[]},mychar.quest[select.quest].med.push(s)):"object"==typeof s&&"imp"==select.quest.slice(0,3)?mychar.quest[select.quest]={vol:chobj("quest",select.quest)+s[0],lvl:chobj("quest",select.quest)?mychar.quest[select.quest].lvl:[],sk:s[1]}:mychar.quest[select.quest]={vol:chobj("quest",select.quest)+s,lvl:chobj("quest",select.quest)?mychar.quest[select.quest].lvl:[]},mychar.quest[select.quest].lvl.push(charp.level),settle(),statpoints(),showlistquest()))}))}}function emptyObject(t){for(var s in t)return!1;return!0}function totalurl(t){$("#total").show(),$("#totaltext").val(t)}function total(){$("#total").show();var t=charp.name+" "+feat.live[0]+" XP\n";for(var s in stats)t+=stats[s][2]+" ";for(var s in t+="\n"+anytext.traits,traits)mychar.traits[s]&&(t+=texttraits[s][0]+" ");for(var s in t+="\n"+anytext.nav,skills)s in mychar.tags&&(t+=skills[s][1]+" ");if(t+="\n",!emptyObject(mychar.perks)){var a=[];for(var r in mychar.perks)for(var s in mychar.perks[r].lvl)a[mychar.perks[r].lvl[s]]=r;for(var r in a)t+=r+" ур: "+textperk[a[r]][0]+"\n"}var e="";for(var s in skills)if(skills[s][0]>80){var i=0;for(var r in mychar.skills)null!=mychar.skills[r][s]&&(i+=mychar.skills[r][s][0],1==r&&(i+=mychar.skills[r][s][1]));sumperk=i+startskills[s](),sumperk>skills[s][0]&&(sumperk=skills[s][0]),sumperk2=skills[s][0]-sumperk,e+=skills[s][2]+": "+skills[s][0]+(sumperk2>0?" = "+sumperk+" + "+sumperk2:"")+"\n"}for(var s in""!=e&&(t+="\n"+anytext.procnav+"\n"+e),e="",questinfo)if("imp"==s.substr(0,3)&&s in mychar.quest){const t=["%n%","%r%"];let a=questinfo[s][mychar.quest[s].vol-1],r=mychar.quest[s]?.sk;if(r)for(let s=0;s<r.length;s++)a=a.replace(t[s],r[s][1]);e+=a+"\n"}if(""!=e&&(t+="\n"+anytext.imp+"\n"+e),e="",mychar.quest.medals&&mychar.quest.medals.med){var n={skillpoint:[0,0],carryweight:[0,0],hp:[0,0]};for(var s in mychar.quest.medals.med){var l=mychar.quest.medals.med[s];1==l[0]||4==l[0]||5==l[0]?(n.skillpoint[0]+=l[0]>1?4==l[0]?10:80:1,n.skillpoint[1]+=l[1]):2==l[0]?(n.carryweight[0]+=15,n.carryweight[1]+=l[1]):3==l[0]&&(n.hp[0]+=1,n.hp[1]+=l[1])}n.skillpoint[1]&&(e+=n.skillpoint[1]+anytext.medals_in+n.skillpoint[0]+anytext.medals_skillpoint+"\n"),n.carryweight[1]&&(e+=n.carryweight[1]+anytext.medals_in+n.carryweight[0]+anytext.medals_carryweight+"\n"),n.hp[1]&&(e+=n.hp[1]+anytext.medals_in+n.hp[0]+anytext.medals_hp+"\n")}for(var s in(""!=e||mychar.quest.medals)&&(t+="\n"+anytext.medals+mychar.quest.medals.vol+"\n"+e),e="",mychar.book)"prewar"!=s&&mychar.book[s][0]<10?e+=textbook[s]+" "+(10-mychar.book[s][0])+"\n":"prewar"==s&&mychar.book[s][0]<20&&(e+=textbook[s]+" "+(20-mychar.book[s][0])+"\n");""!=e&&(t+="\n"+anytext.book+"\n"+e),cookiehash&&(t+="http://"+location.host+"/?hash="+cookiehash+"\n"),$("#totaltext").val(t),"function"==typeof autoArr&&autoArr()}function scrollit(t){(t.originalEvent.deltaY||t.originalEvent.detail||t.originalEvent.wheelDelta)>0?$(this).scrollTop(this.scrollTop+12):$(this).scrollTop(this.scrollTop-12),t.preventDefault()}function imgLoaded(t){$(t).parent().addClass("loaded")}function loadbjson(t){var s=JSON.parse(t);loadbuild(s[0],s[1])}function loadbuild(t,s){for(var a in mychar=t,(charp=s).name=decodeURIComponent(charp.name),skills)a in mychar.tags?($("#"+a+"s").css("color","#ABABAB"),$("#"+a).css("color","#ABABAB")):($("#"+a+"s").css("color","#0E0"),$("#"+a).css("color","#0E0"));for(var a in mychar.book)$("#book"+a).html("x"+mychar.book[a][0]);for(var r in leveluping=!0,regi=!0,leveling(),showlistperk(),$("#level").html(charp.level),$("#exp").html(levelexp(charp.level)),$("#nextexp").html(levelexp(charp.level+1)),$("#namenter").html(charp.name),$("#name").html($("#namenter").html().toUpperCase()),numbers($("#numberage"),charp.age),$("#age").html(charp.age),"men"===charp.sex?($("#men").css("backgroundImage","url(img/men.png)"),$("#women").css("backgroundImage",""),$("#sex").html(sextext.men)):"women"===charp.sex&&($("#women").css("backgroundImage","url(img/women.png)"),$("#men").css("backgroundImage",""),$("#sex").html(sextext.women)),numbers($("#point1"),charp.points),numbers($("#point2"),charp.tags),statpoints(),settle(),createlistperk(),showlistquest(),mychar.tperk)if("skills"in perk[r][7])for(var e in perk[r][7].skills)$("#s"+e).html(perk[r][7].skills[e]+"%")}function setbuild(){if(!send){var t=charp.name;charp.name=encodeURIComponent(charp.name);var s=[mychar,charp];if(online){var a="setbuild="+encodeURIComponent(Base64.encode(lzw(JSON.stringify(s))))+"&name="+t;cookiehash&&(a+="&hash="+cookiehash),send=!0,$.ajax({type:"POST",url:"basechar.php",data:a,success:function(t){t?(send=!1,save=!0,cookiehash=Cookies.get("hash"),totalurl("http://"+location.host+"/?hash="+Cookies.get("hash"))):totalurl(anytext.nosave)}})}else save=!0,totalurl(Base64.encode(lzw(JSON.stringify(s))));charp.name=t}}function getbuild(t){t=null==t?cookiehash:t,$.ajax({type:"POST",url:"basechar.php",data:"getbuild="+t,success:function(t){if(t)if("["==t[0])loadbjson(t);else if("W"==t[0]){var s=Base64.decode(t);loadbjson(s=delzw(s))}}})}function maxMedals(){return 60+10*stats.CHA[2]}function main(){window==top?$("body").css("background-color","rgba(0, 0, 0, 255)"):$("body").css("background-color","rgba(0, 0, 0, 0)"),$("#totaltext").on("wheel",scrollit),$("#crlistperk").on("wheel",scrollit),$("#selectperk").on("wheel",scrollit),$("#selectquest").on("wheel",scrollit),$("#textparm").on("wheel",scrollit),$("#textparms").on("wheel",scrollit),$("#textparmq").on("wheel",scrollit),$("#answ").on("wheel",scrollit);for(var t=1;t<4;t++)$("#textlist"+t).on("wheel",scrollit);$("#buttreq").click((function(t){req?($("#buttreq").css("background-color","rgba(255, 0, 0, 0.55)"),$("#textparm").show(),$("#textparmreq").hide()):($("#buttreq").css("background-color","rgba(0, 255, 0, 0.55)"),$("#textparm").hide(),$("#textparmreq").show()),req=!req})),$("#totalkey").click(total),$("#canceltotal").click((function(){$("#total").hide()})),$("#upscroll").click((function(){var t=$("#selectperk");t.scrollTop(t.scrollTop()-12)})),$("#downscroll").click((function(){var t=$("#selectperk");t.scrollTop(t.scrollTop()+12)})),$("#upscrollist").click((function(){var t=$("#crlistperk");t.scrollTop(t.scrollTop()-36)})),$("#downscrollist").click((function(){var t=$("#crlistperk");t.scrollTop(t.scrollTop()+36)})),$("#selectbuild").change((function(){var t=$("#selectbuild option:selected").val();cookiehash=t,document.location.search="?hash="+t})),$("#men").click(changesex),$("#women").click(changesex),document.addEventListener("keydown",modalCloseEsc),$("#wrap").click(modalCloseClick),$(document).keydown((function(t){if(select.crperk)if(40==t.which){var s=$("#"+select.crperk).next();if(null==s.attr("id"))return;s.attr("id").length<8&&(s=s.next()),s.position().top>=408&&s.parent().scrollTop(s.parent().scrollTop()+(s.position().top-408)),select.crperk.substr(5)in mychar.tperk?$("#"+select.crperk).css("color","#07B"):$("#"+select.crperk).css("color","#00AB00"),select.crperk=s.attr("id"),s.css("color","#00FF00"),infoparm("perks",s.attr("id").substr(5))}else{if(38!=t.which)return;var a=$("#"+select.crperk).prev();if("lists3"==a.attr("id"))return;a.attr("id").length<8&&(a=a.prev()),a.position().top<0&&a.parent().scrollTop(a.parent().scrollTop()+a.position().top),12==a.parent().scrollTop()&&a.parent().scrollTop(0),select.crperk.substr(5)in mychar.tperk?$("#"+select.crperk).css("color","#07B"):$("#"+select.crperk).css("color","#00AB00"),select.crperk=a.attr("id"),a.css("color","#00FF00"),infoparm("perks",a.attr("id").substr(5))}})),$("#name").click(showthis),$("#age").click(showthis),$("#sex").click(showthis),$("#plusage").click(plusage),$("#minusage").click(minusage),$("#namenter").keydown((function(t){13===t.keyCode&&modalCloseClick()})),$("#pasenter").keydown((function(t){13===t.keyCode&&modalCloseClick()})),$("#namenter").keyup((function(){$("#name").html($("#namenter").html().toUpperCase()),charp.name=$("#namenter").html()})),$("#done").click(leveling),$("#cancel").click(reg),$("#doneperk").click((function(){$("#perk").hide(),$("#perk").animate({opacity:"0"},200),select.perk&&(addperk(select.perk),charp.perkpoint=0,$("#textswitch1").removeClass("perkup"),showlistperk(),settle(),statpoints(),numbers($("#point1"),charp.points))})),$("#cancelperk").click((function(){$("#perk").hide(),$("#perk").animate({opacity:"0"},200)})),$("#donequest").click((function(){$("#quest").hide(),select.quest&&("per_ncr"!=select.quest&&"medals"!=select.quest&&"drayfild"!=select.quest&&"imp"!=select.quest.substr(0,3)&&(mychar.quest[select.quest]={vol:chobj("quest",select.quest)+1,lvl:chobj("quest",select.quest)?mychar.quest[select.quest].lvl:[]},mychar.quest[select.quest].lvl.push(charp.level)),quest[select.quest][6](),showlistquest(),settle(),statpoints())})),$("#cancelquest").click((function(){$("#quest").hide()})),$("#levelup").click(levelup),$("#leveldown").click(leveldown);for(t=1;t<4;t++)$("#textswitch"+t).click(switchinfo);for(var s in mychar.book)$("#book"+s).click(plusbook);for(var s in stats)$("#plus"+s).click(plusspec),$("#minus"+s).click(minusspec),$("#"+s+"n").click((function(){infoparm("stats",this.id.substr(0,3))})),$("#"+s+"t").click((function(){infoparm("stats",this.id.substr(0,3))})),$("#"+s).click((function(){infoparm("stats",this.id.substr(0,3))}));for(var s in traits)$("#key"+s).mousedown((function(){$("#lkey"+this.id.substr(3)).html('<img src="img/small_key.png" onload="imgLoaded(this)">')})),$("#key"+s).mouseup((function(){$("#lkey"+this.id.substr(3)).html("")})),$("#key"+s).click(trait),$("#"+s).click((function(){infoparm("traits",this.id)})).html(texttraits[s][0]);for(var s in skills)$("#key"+s).mousedown((function(){$("#lkey"+this.id.substr(3)).html('<img src="img/small_key.png" onload="imgLoaded(this)">')})),$("#key"+s).mouseup((function(){$("#lkey"+this.id.substr(3)).html("")})),$("#key"+s).click(tags),$("#butt"+s).click(selectskill),$("#butt"+s).click((function(){infoparm("skills",this.id.substr(4))})),$("#"+s+"s").html(skills[s][2]);$("#titlelist").click((function(){++mode>1&&(mode=0),$("#titlelist").html(mod[mode]),createlistperk(),decalc(),$("#search").val(""),textSeachPerk=""})),$("#totaltext").on("input",(function(){var t=$("#totaltext").val();"["==t[0]||"W"==t[0]?$("#loadtotal").show():$("#loadtotal").hide()})),$("#loadtotal").click((function(){var t=$("#totaltext").val();if("["==t[0])loadbjson(delzw(t));else if("W"==t[0]){var s=Base64.decode(t);loadbjson(s=delzw(s))}$("#total").hide()})),$("#loadkey").click((function(){totalurl("")})),$("#search").on("input",(function(t){textSeachPerk=t.currentTarget.value.toLowerCase(),createlistperk()})),$("#titlelist").html(mod[mode]),$("#men").css("backgroundImage","url(img/men.png)"),$("#age").html(charp.age),numbers($("#numberage"),charp.age),numbers($("#point1"),charp.points),numbers($("#point2"),charp.tags),statpoints(),settle(),createlistperk(),cookiehash&&getbuild();var a=new Image;a.src="img/reg.png",a.onload=function(){regi&&($("#main").css("backgroundImage","url("+a.src+")"),$("#main").animate({opacity:"1"},500))}}window.addEventListener("load",main);